<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 MS2-Annotation | Instructions_MS2-workflow_robot</title>
  <meta name="description" content="Chapter 5 MS2-Annotation | Instructions_MS2-workflow_robot" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 MS2-Annotation | Instructions_MS2-workflow_robot" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 MS2-Annotation | Instructions_MS2-workflow_robot" />
  
  
  

<meta name="author" content="Muyao Xi" />


<meta name="date" content="2023-03-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ms2-preprocessing-targeted.html"/>
<link rel="next" href="small-tools.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Instructions_MS2-workflow</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="file-converter.html"><a href="file-converter.html"><i class="fa fa-check"></i><b>2</b> File converter</a>
<ul>
<li class="chapter" data-level="2.1" data-path="file-converter.html"><a href="file-converter.html#source-paths-on-the-server"><i class="fa fa-check"></i><b>2.1</b> Source paths on the server</a></li>
<li class="chapter" data-level="2.2" data-path="file-converter.html"><a href="file-converter.html#specify-the-polarity"><i class="fa fa-check"></i><b>2.2</b> Specify the polarity 🕵</a></li>
<li class="chapter" data-level="2.3" data-path="file-converter.html"><a href="file-converter.html#path-of-application-of-openms"><i class="fa fa-check"></i><b>2.3</b> Path of application of openms 🕵</a></li>
<li class="chapter" data-level="2.4" data-path="file-converter.html"><a href="file-converter.html#path-of-storing-files-.mzml-exported-from-dataanalysis-for-each-polarity"><i class="fa fa-check"></i><b>2.4</b> Path of storing files (.mzML) exported from dataanalysis for each polarity 🕵</a></li>
<li class="chapter" data-level="2.5" data-path="file-converter.html"><a href="file-converter.html#conduct"><i class="fa fa-check"></i><b>2.5</b> Conduct</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="file-converter.html"><a href="file-converter.html#add-extension-if-not-available-to-files-exported-from-dataanalysis"><i class="fa fa-check"></i><b>2.5.1</b> Add extension (if not available) to files exported from dataanalysis</a></li>
<li class="chapter" data-level="2.5.2" data-path="file-converter.html"><a href="file-converter.html#file-converter-for-adapting-to-run-xcms"><i class="fa fa-check"></i><b>2.5.2</b> File converter for adapting to run XCMS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html"><i class="fa fa-check"></i><b>3</b> MS2 preprocessing untargeted</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#xcms"><i class="fa fa-check"></i><b>3.1</b> XCMS</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#source-paths-on-the-server-1"><i class="fa fa-check"></i><b>3.1.1</b> Source paths on the server</a></li>
<li class="chapter" data-level="3.1.2" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#provide-polarity"><i class="fa fa-check"></i><b>3.1.2</b> Provide polarity 🕵</a></li>
<li class="chapter" data-level="3.1.3" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#path-of-storing-.mzml-files-must-have-transferred-by-openms"><i class="fa fa-check"></i><b>3.1.3</b> Path of storing .mzML files (must have transferred by OpenMS) 🕵</a></li>
<li class="chapter" data-level="3.1.4" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#path-of-storing-outputs"><i class="fa fa-check"></i><b>3.1.4</b> Path of storing outputs 🕵</a></li>
<li class="chapter" data-level="3.1.5" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#parameters-for-preprocessing"><i class="fa fa-check"></i><b>3.1.5</b> Parameters for preprocessing 🕵</a>
<ul>
<li class="chapter" data-level="3.1.5.1" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#filter-the-compounds-eluted-too-early-and-too-late"><i class="fa fa-check"></i><b>3.1.5.1</b> Filter the compounds eluted too early and too late 🕵</a></li>
<li class="chapter" data-level="3.1.5.2" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#peak-picking"><i class="fa fa-check"></i><b>3.1.5.2</b> Peak picking 🕵</a></li>
<li class="chapter" data-level="3.1.5.3" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#grouping-for-alignment"><i class="fa fa-check"></i><b>3.1.5.3</b> Grouping for alignment 🕵</a></li>
<li class="chapter" data-level="3.1.5.4" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#alignment"><i class="fa fa-check"></i><b>3.1.5.4</b> Alignment 🕵</a></li>
<li class="chapter" data-level="3.1.5.5" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#grouping-again-with-stricter-condition-after-alignment"><i class="fa fa-check"></i><b>3.1.5.5</b> Grouping again with stricter condition after alignment 🕵</a></li>
<li class="chapter" data-level="3.1.5.6" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#gap-filling"><i class="fa fa-check"></i><b>3.1.5.6</b> Gap filling 🕵</a></li>
<li class="chapter" data-level="3.1.5.7" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#conducting-xcms"><i class="fa fa-check"></i><b>3.1.5.7</b> Conducting XCMS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#extraction-of-ms2-spectra"><i class="fa fa-check"></i><b>3.2</b> Extraction of MS2-spectra</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#source-paths-on-the-server-2"><i class="fa fa-check"></i><b>3.2.1</b> Source paths on the server</a></li>
<li class="chapter" data-level="3.2.2" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#provide-the-polarity"><i class="fa fa-check"></i><b>3.2.2</b> Provide the polarity 🕵</a></li>
<li class="chapter" data-level="3.2.3" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#path-of-xcmsnexp-object-after-conducting-xcms"><i class="fa fa-check"></i><b>3.2.3</b> Path of XCMSnExp object after conducting XCMS 🕵</a></li>
<li class="chapter" data-level="3.2.4" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#path-of-storing-outputs-1"><i class="fa fa-check"></i><b>3.2.4</b> Path of storing outputs 🕵</a></li>
<li class="chapter" data-level="3.2.5" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#parameters-for-extracting-ms2-spectra"><i class="fa fa-check"></i><b>3.2.5</b> Parameters for extracting MS2 spectra 🕵</a>
<ul>
<li class="chapter" data-level="3.2.5.1" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#extraction-threshold-of-rt-and-mz-for-extraction-and-what-type-of-object-return"><i class="fa fa-check"></i><b>3.2.5.1</b> Extraction: Threshold of rt and m/z for extraction and what type of object return 🕵</a></li>
</ul></li>
<li class="chapter" data-level="3.2.6" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#combining-threshold-of-mz-proportion-among-all-samples-type-for-combining-function-for-combining-mz-and-intensity"><i class="fa fa-check"></i><b>3.2.6</b> Combining: Threshold of mz, proportion among all samples, type for combining, function for combining mz and intensity 🕵</a></li>
<li class="chapter" data-level="3.2.7" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#optional-but-recommended-plot-the-ms2-spectra"><i class="fa fa-check"></i><b>3.2.7</b> (Optional but recommended) Plot the MS2 spectra ✈️</a></li>
<li class="chapter" data-level="3.2.8" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#optional-but-reconmended-reduce-the-number-of-the-ms2-spectra"><i class="fa fa-check"></i><b>3.2.8</b> (Optional but reconmended) Reduce the number of the MS2 spectra ✈️</a></li>
<li class="chapter" data-level="3.2.9" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#conduct-the-extraction-of-ms2-spectra"><i class="fa fa-check"></i><b>3.2.9</b> Conduct the extraction of MS2 spectra</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#optional-camera"><i class="fa fa-check"></i><b>3.3</b> (Optional) CAMERA</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#source-paths-on-the-server-3"><i class="fa fa-check"></i><b>3.3.1</b> Source paths on the server</a></li>
<li class="chapter" data-level="3.3.2" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#provide-the-polarity-1"><i class="fa fa-check"></i><b>3.3.2</b> Provide the polarity 🕵</a></li>
<li class="chapter" data-level="3.3.3" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#path-of-storing-outputs-2"><i class="fa fa-check"></i><b>3.3.3</b> Path of storing outputs 🕵</a></li>
<li class="chapter" data-level="3.3.4" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#read-xcmsnexp-object-after-conducting-xcms"><i class="fa fa-check"></i><b>3.3.4</b> Read XCMSnExp object after conducting XCMS 🕵</a></li>
<li class="chapter" data-level="3.3.5" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#parameters-for-camera"><i class="fa fa-check"></i><b>3.3.5</b> Parameters for CAMERA 🕵</a>
<ul>
<li class="chapter" data-level="3.3.5.1" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#grouping"><i class="fa fa-check"></i><b>3.3.5.1</b> Grouping 🕵</a></li>
<li class="chapter" data-level="3.3.5.2" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#correlation"><i class="fa fa-check"></i><b>3.3.5.2</b> correlation 🕵</a></li>
<li class="chapter" data-level="3.3.5.3" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#find-isotopes"><i class="fa fa-check"></i><b>3.3.5.3</b> find isotopes 🕵</a></li>
<li class="chapter" data-level="3.3.5.4" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#find-adducts"><i class="fa fa-check"></i><b>3.3.5.4</b> find adducts 🕵</a></li>
</ul></li>
<li class="chapter" data-level="3.3.6" data-path="ms2-preprocessing-untargeted.html"><a href="ms2-preprocessing-untargeted.html#conduct-camera"><i class="fa fa-check"></i><b>3.3.6</b> Conduct CAMERA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html"><i class="fa fa-check"></i><b>4</b> MS2 preprocessing targeted</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#xcms_check-retention-time"><i class="fa fa-check"></i><b>4.1</b> XCMS_check retention time</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#source-paths-on-the-server-4"><i class="fa fa-check"></i><b>4.1.1</b> Source paths on the server</a></li>
<li class="chapter" data-level="4.1.2" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#provide-polarity-1"><i class="fa fa-check"></i><b>4.1.2</b> Provide polarity 🕵</a></li>
<li class="chapter" data-level="4.1.3" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#path-of-storing-.mzml-files-without-filenames"><i class="fa fa-check"></i><b>4.1.3</b> Path of storing .mzML files without filenames 🕵</a></li>
<li class="chapter" data-level="4.1.4" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#path-of-storing-outputs-3"><i class="fa fa-check"></i><b>4.1.4</b> Path of storing outputs 🕵</a></li>
<li class="chapter" data-level="4.1.5" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#filename-for-containing-information-of-standards-including-absolute-path-please-fill-in-the-provided-template-as-well-as-the-sheet-name"><i class="fa fa-check"></i><b>4.1.5</b> Filename for containing information of standards including absolute path (Please fill in the provided template) as well as the sheet name 🕵</a></li>
<li class="chapter" data-level="4.1.6" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#colname-of-retention-time"><i class="fa fa-check"></i><b>4.1.6</b> Colname of retention time 🕵</a></li>
<li class="chapter" data-level="4.1.7" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#parameters-for-getting-chromatogram"><i class="fa fa-check"></i><b>4.1.7</b> Parameters for getting chromatogram 🕵</a></li>
<li class="chapter" data-level="4.1.8" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#threshold-for-retention-time-minutes-and-mz-for-ploting-chromatogram"><i class="fa fa-check"></i><b>4.1.8</b> Threshold for retention time (minutes) and m/z for ploting chromatogram 🕵</a>
<ul>
<li class="chapter" data-level="4.1.8.1" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#conducting"><i class="fa fa-check"></i><b>4.1.8.1</b> Conducting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#extraction-of-ms2-spectra-1"><i class="fa fa-check"></i><b>4.2</b> Extraction of MS2-spectra</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#source-paths-on-the-server-5"><i class="fa fa-check"></i><b>4.2.1</b> Source paths on the server</a></li>
<li class="chapter" data-level="4.2.2" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#provide-polarity-2"><i class="fa fa-check"></i><b>4.2.2</b> Provide polarity 🕵</a></li>
<li class="chapter" data-level="4.2.3" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#path-of-storing-.mzml-files-without-filenames-1"><i class="fa fa-check"></i><b>4.2.3</b> Path of storing .mzML files without filenames 🕵</a></li>
<li class="chapter" data-level="4.2.4" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#path-of-storing-outputs-4"><i class="fa fa-check"></i><b>4.2.4</b> Path of storing outputs 🕵</a></li>
<li class="chapter" data-level="4.2.5" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#absolute-path-of-template-with-essential-information-of-standards"><i class="fa fa-check"></i><b>4.2.5</b> Absolute path of template with essential information of standards 🕵</a></li>
<li class="chapter" data-level="4.2.6" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#colname-of-retention-time-1"><i class="fa fa-check"></i><b>4.2.6</b> colname of retention time 🕵</a></li>
<li class="chapter" data-level="4.2.7" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#parameters-for-extracting-ms2-spectra-1"><i class="fa fa-check"></i><b>4.2.7</b> Parameters for extracting MS2 spectra 🕵</a>
<ul>
<li class="chapter" data-level="4.2.7.1" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#extraction-threshold-of-rt-and-mz-for-extraction"><i class="fa fa-check"></i><b>4.2.7.1</b> Extraction: Threshold of rt and m/z for extraction 🕵</a></li>
<li class="chapter" data-level="4.2.7.2" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#how-many-maximal-number-of-scans-you-would-like-to-keep-for-further-getting-combined-spectrum-for-each-std"><i class="fa fa-check"></i><b>4.2.7.2</b> How many maximal number of scans you would like to keep for further getting combined spectrum for each std 🕵</a></li>
<li class="chapter" data-level="4.2.7.3" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#combining-threshold-of-mz-proportion-among-all-samples-type-for-combining-function-for-combining-mz-and-intensity-1"><i class="fa fa-check"></i><b>4.2.7.3</b> Combining: Threshold of mz, proportion among all samples, type for combining, function for combining mz and intensity 🕵</a></li>
</ul></li>
<li class="chapter" data-level="4.2.8" data-path="ms2-preprocessing-targeted.html"><a href="ms2-preprocessing-targeted.html#conducting-1"><i class="fa fa-check"></i><b>4.2.8</b> Conducting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ms2-annotation.html"><a href="ms2-annotation.html"><i class="fa fa-check"></i><b>5</b> MS2-Annotation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#gnps-submit-jobs-based-on-cmn"><i class="fa fa-check"></i><b>5.1</b> GNPS-Submit jobs based on CMN</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#upload-files"><i class="fa fa-check"></i><b>5.1.1</b> Upload files</a>
<ul>
<li class="chapter" data-level="5.1.1.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#source-paths-on-the-server-and-relevant-function"><i class="fa fa-check"></i><b>5.1.1.1</b> Source paths on the server and relevant function</a></li>
<li class="chapter" data-level="5.1.1.2" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-polarity-upper-case"><i class="fa fa-check"></i><b>5.1.1.2</b> Provide polarity (upper case) 🕵</a></li>
<li class="chapter" data-level="5.1.1.3" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-project-information"><i class="fa fa-check"></i><b>5.1.1.3</b> Provide project information 🕵</a></li>
<li class="chapter" data-level="5.1.1.4" data-path="ms2-annotation.html"><a href="ms2-annotation.html#information-related-to-run-jobs-on-gnps-or-computer-room"><i class="fa fa-check"></i><b>5.1.1.4</b> Information related to run jobs on GNPS or computer room 🕵</a></li>
<li class="chapter" data-level="5.1.1.5" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-the-path-of-storing-files-without-filenames"><i class="fa fa-check"></i><b>5.1.1.5</b> Provide the path of storing files without filenames 🕵</a></li>
<li class="chapter" data-level="5.1.1.6" data-path="ms2-annotation.html"><a href="ms2-annotation.html#upload-files-into-server-ftp"><i class="fa fa-check"></i><b>5.1.1.6</b> Upload files into server (FTP)</a></li>
</ul></li>
<li class="chapter" data-level="5.1.2" data-path="ms2-annotation.html"><a href="ms2-annotation.html#prerequisites-before-generating-parameters-and-submitting-jobs"><i class="fa fa-check"></i><b>5.1.2</b> Prerequisites before generating parameters and submitting jobs 🕵</a></li>
<li class="chapter" data-level="5.1.3" data-path="ms2-annotation.html"><a href="ms2-annotation.html#cmn"><i class="fa fa-check"></i><b>5.1.3</b> CMN</a>
<ul>
<li class="chapter" data-level="5.1.3.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#generate-parameters"><i class="fa fa-check"></i><b>5.1.3.1</b> Generate parameters 🕵</a></li>
<li class="chapter" data-level="5.1.3.2" data-path="ms2-annotation.html"><a href="ms2-annotation.html#submit-cmn"><i class="fa fa-check"></i><b>5.1.3.2</b> Submit CMN</a></li>
</ul></li>
<li class="chapter" data-level="5.1.4" data-path="ms2-annotation.html"><a href="ms2-annotation.html#dereplicator-after-cmn-done"><i class="fa fa-check"></i><b>5.1.4</b> Dereplicator (after CMN done)</a>
<ul>
<li class="chapter" data-level="5.1.4.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#generate-parameters-1"><i class="fa fa-check"></i><b>5.1.4.1</b> Generate parameters 🕵</a></li>
<li class="chapter" data-level="5.1.4.2" data-path="ms2-annotation.html"><a href="ms2-annotation.html#submit-dereplicator"><i class="fa fa-check"></i><b>5.1.4.2</b> Submit Dereplicator</a></li>
</ul></li>
<li class="chapter" data-level="5.1.5" data-path="ms2-annotation.html"><a href="ms2-annotation.html#dereplicator-plus"><i class="fa fa-check"></i><b>5.1.5</b> Dereplicator plus</a>
<ul>
<li class="chapter" data-level="5.1.5.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#generate-parameters-2"><i class="fa fa-check"></i><b>5.1.5.1</b> Generate parameters 🕵</a></li>
<li class="chapter" data-level="5.1.5.2" data-path="ms2-annotation.html"><a href="ms2-annotation.html#submit-dereplicator-plus"><i class="fa fa-check"></i><b>5.1.5.2</b> Submit Dereplicator plus</a></li>
</ul></li>
<li class="chapter" data-level="5.1.6" data-path="ms2-annotation.html"><a href="ms2-annotation.html#nap"><i class="fa fa-check"></i><b>5.1.6</b> NAP</a>
<ul>
<li class="chapter" data-level="5.1.6.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#generate-parameters-3"><i class="fa fa-check"></i><b>5.1.6.1</b> Generate parameters 🕵</a></li>
<li class="chapter" data-level="5.1.6.2" data-path="ms2-annotation.html"><a href="ms2-annotation.html#submit-nap"><i class="fa fa-check"></i><b>5.1.6.2</b> Submit NAP</a></li>
</ul></li>
<li class="chapter" data-level="5.1.7" data-path="ms2-annotation.html"><a href="ms2-annotation.html#ms2lda"><i class="fa fa-check"></i><b>5.1.7</b> MS2LDA</a>
<ul>
<li class="chapter" data-level="5.1.7.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#generate-parameters-4"><i class="fa fa-check"></i><b>5.1.7.1</b> Generate parameters 🕵</a></li>
<li class="chapter" data-level="5.1.7.2" data-path="ms2-annotation.html"><a href="ms2-annotation.html#submit-ms2lda"><i class="fa fa-check"></i><b>5.1.7.2</b> Submit MS2LDA</a></li>
</ul></li>
<li class="chapter" data-level="5.1.8" data-path="ms2-annotation.html"><a href="ms2-annotation.html#mne-molnetenhancer"><i class="fa fa-check"></i><b>5.1.8</b> MNE (MolNetEnhancer)</a>
<ul>
<li class="chapter" data-level="5.1.8.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#generate-parameters-5"><i class="fa fa-check"></i><b>5.1.8.1</b> Generate parameters 🕵</a></li>
<li class="chapter" data-level="5.1.8.2" data-path="ms2-annotation.html"><a href="ms2-annotation.html#submit-mne"><i class="fa fa-check"></i><b>5.1.8.2</b> Submit MNE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="ms2-annotation.html"><a href="ms2-annotation.html#gnps-submit-jobs-based-on-fbmn"><i class="fa fa-check"></i><b>5.2</b> GNPS-Submit jobs based on FBMN</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#form-quantification-table"><i class="fa fa-check"></i><b>5.2.1</b> Form quantification table</a>
<ul>
<li class="chapter" data-level="5.2.1.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#source-paths-on-the-server-6"><i class="fa fa-check"></i><b>5.2.1.1</b> Source paths on the server</a></li>
<li class="chapter" data-level="5.2.1.2" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-the-polarity-2"><i class="fa fa-check"></i><b>5.2.1.2</b> Provide the polarity 🕵</a></li>
<li class="chapter" data-level="5.2.1.3" data-path="ms2-annotation.html"><a href="ms2-annotation.html#path-of-storing-outputs-5"><i class="fa fa-check"></i><b>5.2.1.3</b> Path of storing outputs 🕵</a></li>
<li class="chapter" data-level="5.2.1.4" data-path="ms2-annotation.html"><a href="ms2-annotation.html#path-of-extracted-ms2-spectra"><i class="fa fa-check"></i><b>5.2.1.4</b> Path of extracted MS2 spectra 🕵</a></li>
<li class="chapter" data-level="5.2.1.5" data-path="ms2-annotation.html"><a href="ms2-annotation.html#path-of-object-after-conducting-xcms"><i class="fa fa-check"></i><b>5.2.1.5</b> Path of object after conducting XCMS 🕵</a></li>
<li class="chapter" data-level="5.2.1.6" data-path="ms2-annotation.html"><a href="ms2-annotation.html#optional-path-of-object-camera-if-conduct-camera"><i class="fa fa-check"></i><b>5.2.1.6</b> (Optional) Path of object CAMERA (if conduct CAMERA) ✈️</a></li>
<li class="chapter" data-level="5.2.1.7" data-path="ms2-annotation.html"><a href="ms2-annotation.html#conduct-to-get-quantification-table-for-fbmn-on-gnps"><i class="fa fa-check"></i><b>5.2.1.7</b> Conduct to get quantification table for FBMN on GNPS</a></li>
</ul></li>
<li class="chapter" data-level="5.2.2" data-path="ms2-annotation.html"><a href="ms2-annotation.html#upload-files-generate-parameters-and-submit-jobs"><i class="fa fa-check"></i><b>5.2.2</b> Upload files, generate parameters, and submit jobs</a>
<ul>
<li class="chapter" data-level="5.2.2.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#upload-files-1"><i class="fa fa-check"></i><b>5.2.2.1</b> Upload files</a></li>
<li class="chapter" data-level="5.2.2.2" data-path="ms2-annotation.html"><a href="ms2-annotation.html#prerequisites-before-generating-parameters-and-submitting-jobs-1"><i class="fa fa-check"></i><b>5.2.2.2</b> Prerequisites before generating parameters and submitting jobs 🕵</a></li>
<li class="chapter" data-level="5.2.2.3" data-path="ms2-annotation.html"><a href="ms2-annotation.html#fbmn"><i class="fa fa-check"></i><b>5.2.2.3</b> FBMN</a></li>
<li class="chapter" data-level="5.2.2.4" data-path="ms2-annotation.html"><a href="ms2-annotation.html#dereplicator-plus-1"><i class="fa fa-check"></i><b>5.2.2.4</b> Dereplicator plus</a></li>
<li class="chapter" data-level="5.2.2.5" data-path="ms2-annotation.html"><a href="ms2-annotation.html#nap-1"><i class="fa fa-check"></i><b>5.2.2.5</b> NAP</a></li>
<li class="chapter" data-level="5.2.2.6" data-path="ms2-annotation.html"><a href="ms2-annotation.html#optional-ms2lda"><i class="fa fa-check"></i><b>5.2.2.6</b> (Optional) MS2LDA ✈️</a></li>
<li class="chapter" data-level="5.2.2.7" data-path="ms2-annotation.html"><a href="ms2-annotation.html#mne-molnetenhancer-1"><i class="fa fa-check"></i><b>5.2.2.7</b> MNE (MolNetEnhancer)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ms2-annotation.html"><a href="ms2-annotation.html#gnps-download-jobs"><i class="fa fa-check"></i><b>5.3</b> GNPS-Download jobs</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#source-paths-on-the-server-7"><i class="fa fa-check"></i><b>5.3.1</b> Source paths on the server 🕵</a></li>
<li class="chapter" data-level="5.3.2" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-polarity-upper-case-2"><i class="fa fa-check"></i><b>5.3.2</b> Provide polarity (upper case) 🕵</a></li>
<li class="chapter" data-level="5.3.3" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-the-path-of-storing-downloaded-files"><i class="fa fa-check"></i><b>5.3.3</b> Provide the path of storing downloaded files 🕵</a></li>
<li class="chapter" data-level="5.3.4" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-project-information-2"><i class="fa fa-check"></i><b>5.3.4</b> Provide project information 🕵</a></li>
<li class="chapter" data-level="5.3.5" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-the-absolute-path-of-list-of-job-ids-by-including-the-name-of-that-list"><i class="fa fa-check"></i><b>5.3.5</b> Provide the absolute path of “list of job ids” by including the name of that list 🕵</a></li>
<li class="chapter" data-level="5.3.6" data-path="ms2-annotation.html"><a href="ms2-annotation.html#download-results-from-the-list-of-job-ids"><i class="fa fa-check"></i><b>5.3.6</b> Download results from the list of job ids</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ms2-annotation.html"><a href="ms2-annotation.html#ms2-inhouse-library-v.s.-experimental-data"><i class="fa fa-check"></i><b>5.4</b> MS2-inhouse-library v.s. experimental data</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#source-paths-on-the-server-8"><i class="fa fa-check"></i><b>5.4.1</b> Source paths on the server</a></li>
<li class="chapter" data-level="5.4.2" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-polarity-upper-case-3"><i class="fa fa-check"></i><b>5.4.2</b> Provide polarity (upper case) 🕵</a></li>
<li class="chapter" data-level="5.4.3" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-path-of-preprocessed-ms2-spectra-file"><i class="fa fa-check"></i><b>5.4.3</b> Provide path of preprocessed MS2-spectra file 🕵</a></li>
<li class="chapter" data-level="5.4.4" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-the-thresholds"><i class="fa fa-check"></i><b>5.4.4</b> provide the thresholds 🕵</a></li>
<li class="chapter" data-level="5.4.5" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-the-path-of-storing-output"><i class="fa fa-check"></i><b>5.4.5</b> Provide the path of storing output 🕵</a></li>
<li class="chapter" data-level="5.4.6" data-path="ms2-annotation.html"><a href="ms2-annotation.html#optional-provide-the-method-for-comparison"><i class="fa fa-check"></i><b>5.4.6</b> (Optional) Provide the method for comparison ✈️</a></li>
<li class="chapter" data-level="5.4.7" data-path="ms2-annotation.html"><a href="ms2-annotation.html#conduct-1"><i class="fa fa-check"></i><b>5.4.7</b> Conduct</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="ms2-annotation.html"><a href="ms2-annotation.html#merge-results-from-different-source"><i class="fa fa-check"></i><b>5.5</b> Merge results from different source</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#merging-outputs-from-jobs-have-run-on-gnps-into-a-table"><i class="fa fa-check"></i><b>5.5.1</b> Merging outputs from jobs have run on GNPS into a table</a>
<ul>
<li class="chapter" data-level="5.5.1.1" data-path="ms2-annotation.html"><a href="ms2-annotation.html#source-paths-on-the-server-and-relevant-function-2"><i class="fa fa-check"></i><b>5.5.1.1</b> Source paths on the server and relevant function</a></li>
<li class="chapter" data-level="5.5.1.2" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-the-path-of-storing-files-downloaded-from-gnps"><i class="fa fa-check"></i><b>5.5.1.2</b> Provide the path of storing files downloaded from GNPS 🕵</a></li>
<li class="chapter" data-level="5.5.1.3" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-the-absolute-path-of-list-of-job-ids-by-including-the-name-of-that-list-1"><i class="fa fa-check"></i><b>5.5.1.3</b> Provide the absolute path of “list of job ids” by including the name of that list 🕵</a></li>
<li class="chapter" data-level="5.5.1.4" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-path-for-storing-the-merged-result"><i class="fa fa-check"></i><b>5.5.1.4</b> Provide path for storing the merged result 🕵</a></li>
<li class="chapter" data-level="5.5.1.5" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-which-method-did-you-use-for-preprocessing-ms2-data"><i class="fa fa-check"></i><b>5.5.1.5</b> Provide which method did you use for preprocessing MS2 data 🕵</a></li>
<li class="chapter" data-level="5.5.1.6" data-path="ms2-annotation.html"><a href="ms2-annotation.html#provide-polarity-upper-case-4"><i class="fa fa-check"></i><b>5.5.1.6</b> Provide polarity (upper case) 🕵</a></li>
<li class="chapter" data-level="5.5.1.7" data-path="ms2-annotation.html"><a href="ms2-annotation.html#conduct-2"><i class="fa fa-check"></i><b>5.5.1.7</b> Conduct</a></li>
<li class="chapter" data-level="5.5.1.8" data-path="ms2-annotation.html"><a href="ms2-annotation.html#merge-library-match-into-gnps-match"><i class="fa fa-check"></i><b>5.5.1.8</b> Merge library-match into GNPS-match</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="small-tools.html"><a href="small-tools.html"><i class="fa fa-check"></i><b>6</b> Small tools</a>
<ul>
<li class="chapter" data-level="6.1" data-path="small-tools.html"><a href="small-tools.html#play-with-various-ids"><i class="fa fa-check"></i><b>6.1</b> Play with various ids</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="small-tools.html"><a href="small-tools.html#provide-identifier-for-grabbing-other-information"><i class="fa fa-check"></i><b>6.1.1</b> Provide identifier for grabbing other information 🕵</a></li>
<li class="chapter" data-level="6.1.2" data-path="small-tools.html"><a href="small-tools.html#provide-filename-and-sheetname-for-searching-other-information"><i class="fa fa-check"></i><b>6.1.2</b> Provide filename and sheetname for searching other information 🕵</a></li>
<li class="chapter" data-level="6.1.3" data-path="small-tools.html"><a href="small-tools.html#provide-the-column-name-of-identifier"><i class="fa fa-check"></i><b>6.1.3</b> Provide the column name of identifier 🕵</a></li>
<li class="chapter" data-level="6.1.4" data-path="small-tools.html"><a href="small-tools.html#what-properties-you-would-like-to-get"><i class="fa fa-check"></i><b>6.1.4</b> What properties you would like to get 🕵</a></li>
<li class="chapter" data-level="6.1.5" data-path="small-tools.html"><a href="small-tools.html#provide-the-path-for-containing-output"><i class="fa fa-check"></i><b>6.1.5</b> Provide the path for containing output 🕵</a></li>
<li class="chapter" data-level="6.1.6" data-path="small-tools.html"><a href="small-tools.html#conduct-4"><i class="fa fa-check"></i><b>6.1.6</b> Conduct</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Instructions_MS2-workflow_robot</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ms2-annotation" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> MS2-Annotation<a href="ms2-annotation.html#ms2-annotation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter consists of:</p>
<ol style="list-style-type: decimal">
<li><p>Submit job of CMN and jobs based on CMN on GNPS (involved uploading files to the server of GNPS)</p></li>
<li><p>Submit job of FBMN and jobs based on FBMN on GNPS (involved uploading files to the server of GNPS)</p></li>
<li><p>Download all results from all submitted jobs</p></li>
<li><p>Compare MS2-experimental data with our in-house library</p></li>
<li><p>Merge the results from each job and library-match</p></li>
</ol>
<div id="gnps-submit-jobs-based-on-cmn" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> GNPS-Submit jobs based on CMN<a href="ms2-annotation.html#gnps-submit-jobs-based-on-cmn" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The script <code>1b.Pipeline_GNPS_upload_submitjobs_based on CMN.R</code> is available under the folder of <code>J:\CBMR\SUN-CBMR-Metabolomics\Workflow\Script\modules\MS2_Annotation</code></p>
<div class="Keats">
<p>The pipeline is for:</p>
<p>1.Uploading files to the server of GNPS.</p>
<p>2.Generating parameters for each job you would like to run.</p>
<p>3.Running CMN (classic molecular network) and a couple of other jobs based on CMN on GNPS.</p>
<div class="Keats_red">
<p>4.Changing the parameters related to the jobs you would like to run.
5.Please pay attention to the filenames <strong>without space</strong></p>
</div>
</div>
<div id="upload-files" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Upload files<a href="ms2-annotation.html#upload-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="source-paths-on-the-server-and-relevant-function" class="section level4 hasAnchor" number="5.1.1.1">
<h4><span class="header-section-number">5.1.1.1</span> Source paths on the server and relevant function<a href="ms2-annotation.html#source-paths-on-the-server-and-relevant-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="ms2-annotation.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;H:/From_SUND/Scripts/utils/utils_MS2_set_up/set_up_paths.R&quot;</span>)</span>
<span id="cb55-2"><a href="ms2-annotation.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_func, <span class="st">&quot;/files_by_FTP.R&quot;</span>))</span></code></pre></div>
</div>
<div id="provide-polarity-upper-case" class="section level4 hasAnchor" number="5.1.1.2">
<h4><span class="header-section-number">5.1.1.2</span> Provide polarity (upper case) 🕵<a href="#provide-polarity-upper-case" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="ms2-annotation.html#cb56-1" aria-hidden="true" tabindex="-1"></a>polarity <span class="ot">&lt;-</span> <span class="st">&quot;POS&quot;</span></span></code></pre></div>
</div>
<div id="provide-project-information" class="section level4 hasAnchor" number="5.1.1.3">
<h4><span class="header-section-number">5.1.1.3</span> Provide project information 🕵<a href="#provide-project-information" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="ms2-annotation.html#cb57-1" aria-hidden="true" tabindex="-1"></a>project_name <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb57-2"><a href="ms2-annotation.html#cb57-2" aria-hidden="true" tabindex="-1"></a>round <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb57-3"><a href="ms2-annotation.html#cb57-3" aria-hidden="true" tabindex="-1"></a>sample_type <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb57-4"><a href="ms2-annotation.html#cb57-4" aria-hidden="true" tabindex="-1"></a>omics <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb57-5"><a href="ms2-annotation.html#cb57-5" aria-hidden="true" tabindex="-1"></a>method <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span></code></pre></div>
</div>
<div id="information-related-to-run-jobs-on-gnps-or-computer-room" class="section level4 hasAnchor" number="5.1.1.4">
<h4><span class="header-section-number">5.1.1.4</span> Information related to run jobs on GNPS or computer room 🕵<a href="#information-related-to-run-jobs-on-gnps-or-computer-room" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="ms2-annotation.html#cb58-1" aria-hidden="true" tabindex="-1"></a>username <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb58-2"><a href="ms2-annotation.html#cb58-2" aria-hidden="true" tabindex="-1"></a>password <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb58-3"><a href="ms2-annotation.html#cb58-3" aria-hidden="true" tabindex="-1"></a>host <span class="ot">&lt;-</span> <span class="st">&quot;massive.ucsd.edu&quot;</span></span>
<span id="cb58-4"><a href="ms2-annotation.html#cb58-4" aria-hidden="true" tabindex="-1"></a>email <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span></code></pre></div>
</div>
<div id="provide-the-path-of-storing-files-without-filenames" class="section level4 hasAnchor" number="5.1.1.5">
<h4><span class="header-section-number">5.1.1.5</span> Provide the path of storing files without filenames 🕵<a href="#provide-the-path-of-storing-files-without-filenames" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><font color = "red">To be sure only files for running CMN from unique polarity within the provided folder</font></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="ms2-annotation.html#cb59-1" aria-hidden="true" tabindex="-1"></a>masterpath <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/test/mzML_openms_MS2_POS&quot;</span></span></code></pre></div>
</div>
<div id="upload-files-into-server-ftp" class="section level4 hasAnchor" number="5.1.1.6">
<h4><span class="header-section-number">5.1.1.6</span> Upload files into server (FTP)<a href="ms2-annotation.html#upload-files-into-server-ftp" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="ms2-annotation.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upload_file_FTP</span>(masterpath, <span class="fu">list.files</span>(masterpath), username, password, host, project_name, round, sample_type, omics, method, polarity)</span></code></pre></div>
</div>
</div>
<div id="prerequisites-before-generating-parameters-and-submitting-jobs" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Prerequisites before generating parameters and submitting jobs 🕵<a href="#prerequisites-before-generating-parameters-and-submitting-jobs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="ms2-annotation.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Provide the path for storing the lists of both parameters and job ids  </span></span>
<span id="cb61-2"><a href="ms2-annotation.html#cb61-2" aria-hidden="true" tabindex="-1"></a>path_outputs_params_jobids <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs&quot;</span></span>
<span id="cb61-3"><a href="ms2-annotation.html#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="ms2-annotation.html#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="ms2-annotation.html#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co">#The two lines below are for storing all parameters related to the workflows you will run</span></span>
<span id="cb61-6"><a href="ms2-annotation.html#cb61-6" aria-hidden="true" tabindex="-1"></a>list_param <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb61-7"><a href="ms2-annotation.html#cb61-7" aria-hidden="true" tabindex="-1"></a>list_jobid <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code></pre></div>
</div>
<div id="cmn" class="section level3 hasAnchor" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> <a href="https://ccms-ucsd.github.io/GNPSDocumentation/networking/">CMN</a><a href="ms2-annotation.html#cmn" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="generate-parameters" class="section level4 hasAnchor" number="5.1.3.1">
<h4><span class="header-section-number">5.1.3.1</span> Generate parameters 🕵<a href="#generate-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="ms2-annotation.html#cb62-1" aria-hidden="true" tabindex="-1"></a>parameters_CMN <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb62-2"><a href="ms2-annotation.html#cb62-2" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;precursor_ion_mass_tolerance&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.02&quot;</span></span>
<span id="cb62-3"><a href="ms2-annotation.html#cb62-3" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;fragment_ion_mass_tolerance&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.02&quot;</span></span>
<span id="cb62-4"><a href="ms2-annotation.html#cb62-4" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;min_pairs_cos&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.7&quot;</span></span>
<span id="cb62-5"><a href="ms2-annotation.html#cb62-5" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;minimum_matched_fragment_ions&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;6&quot;</span></span>
<span id="cb62-6"><a href="ms2-annotation.html#cb62-6" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;maximum_shift&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;500&quot;</span></span>
<span id="cb62-7"><a href="ms2-annotation.html#cb62-7" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;network_topk&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;10&quot;</span></span>
<span id="cb62-8"><a href="ms2-annotation.html#cb62-8" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;minimum_cluster_size&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;2&quot;</span></span>
<span id="cb62-9"><a href="ms2-annotation.html#cb62-9" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;run_mscluster&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;on&quot;</span> </span>
<span id="cb62-10"><a href="ms2-annotation.html#cb62-10" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;maximum_connected_component_size&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;100&quot;</span></span>
<span id="cb62-11"><a href="ms2-annotation.html#cb62-11" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;library_search_min_matched_peaks&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;6&quot;</span></span>
<span id="cb62-12"><a href="ms2-annotation.html#cb62-12" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;score_threshold&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.7&quot;</span></span>
<span id="cb62-13"><a href="ms2-annotation.html#cb62-13" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;search_analogs&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0&quot;</span> </span>
<span id="cb62-14"><a href="ms2-annotation.html#cb62-14" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;maximum_analog_search_mass_difference&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;100&quot;</span> </span>
<span id="cb62-15"><a href="ms2-annotation.html#cb62-15" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;filter_below_std_dev&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.0&quot;</span></span>
<span id="cb62-16"><a href="ms2-annotation.html#cb62-16" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;minimum_peak_intensity&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.0&quot;</span></span>
<span id="cb62-17"><a href="ms2-annotation.html#cb62-17" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;filter_precursor_window&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1&quot;</span></span>
<span id="cb62-18"><a href="ms2-annotation.html#cb62-18" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;filter_library&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1&quot;</span> </span>
<span id="cb62-19"><a href="ms2-annotation.html#cb62-19" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;filter_peaks_10_50Da_window&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1&quot;</span> </span>
<span id="cb62-20"><a href="ms2-annotation.html#cb62-20" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;filter_spectra_from_G6_as_blanks_before_networking&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0&quot;</span> </span>
<span id="cb62-21"><a href="ms2-annotation.html#cb62-21" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;find_related_datasets&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0&quot;</span> </span>
<span id="cb62-22"><a href="ms2-annotation.html#cb62-22" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;create_cluster_buckets_and_qiime2_biom_pcoa_plots_output&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1&quot;</span> </span>
<span id="cb62-23"><a href="ms2-annotation.html#cb62-23" aria-hidden="true" tabindex="-1"></a>parameters_CMN[<span class="st">&quot;create_ili_mapping_output&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0&quot;</span></span></code></pre></div>
</div>
<div id="submit-cmn" class="section level4 hasAnchor" number="5.1.3.2">
<h4><span class="header-section-number">5.1.3.2</span> Submit CMN<a href="ms2-annotation.html#submit-cmn" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="ms2-annotation.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_utils_annotation, <span class="st">&quot;/GNPS_upload_submitjobs.R&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="dereplicator-after-cmn-done" class="section level3 hasAnchor" number="5.1.4">
<h3><span class="header-section-number">5.1.4</span> <a href="https://ccms-ucsd.github.io/GNPSDocumentation/dereplicator/">Dereplicator</a> (after CMN done)<a href="ms2-annotation.html#dereplicator-after-cmn-done" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="generate-parameters-1" class="section level4 hasAnchor" number="5.1.4.1">
<h4><span class="header-section-number">5.1.4.1</span> Generate parameters 🕵<a href="#generate-parameters-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="ms2-annotation.html#cb64-1" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb64-2"><a href="ms2-annotation.html#cb64-2" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator[<span class="st">&quot;precursor_ion_mass_tolerance&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.02&quot;</span></span>
<span id="cb64-3"><a href="ms2-annotation.html#cb64-3" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator[<span class="st">&quot;search_analogs&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;on&quot;</span> <span class="co"># if you do not select, just leave it empty like &quot;&quot;</span></span>
<span id="cb64-4"><a href="ms2-annotation.html#cb64-4" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator[<span class="st">&quot;fragment_ion_mass_tolerance&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.02&quot;</span></span>
<span id="cb64-5"><a href="ms2-annotation.html#cb64-5" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator[<span class="st">&quot;pnp_database&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;pnpdatabase&quot;</span> <span class="co"># &quot;dmisam&quot; for &quot;Extended&quot;, &quot;combined&quot; for &quot;Regular&quot;</span></span>
<span id="cb64-6"><a href="ms2-annotation.html#cb64-6" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator[<span class="st">&quot;max_charge&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;2&quot;</span></span>
<span id="cb64-7"><a href="ms2-annotation.html#cb64-7" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator[<span class="st">&quot;accurate_p_values&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;on&quot;</span> <span class="co"># leave it empty, like &quot;&quot;, if you do not select it</span></span>
<span id="cb64-8"><a href="ms2-annotation.html#cb64-8" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator[<span class="st">&quot;min_number_of_AA&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;5&quot;</span></span>
<span id="cb64-9"><a href="ms2-annotation.html#cb64-9" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator[<span class="st">&quot;max_isotopic_shift&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0&quot;</span> <span class="co"># other options are &quot;1&quot;, &quot;2&quot;</span></span>
<span id="cb64-10"><a href="ms2-annotation.html#cb64-10" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator[<span class="st">&quot;adducts_Na&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span> <span class="co"># if select, give the value like &quot;on&quot;</span></span>
<span id="cb64-11"><a href="ms2-annotation.html#cb64-11" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator[<span class="st">&quot;adducts_K&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span>  <span class="co"># if select, give the value like &quot;on&quot;</span></span>
<span id="cb64-12"><a href="ms2-annotation.html#cb64-12" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator[<span class="st">&quot;max_allowed_modification_mass&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;150&quot;</span> </span>
<span id="cb64-13"><a href="ms2-annotation.html#cb64-13" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator[<span class="st">&quot;min_matched_peaks_with_known_compounds&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;5&quot;</span></span></code></pre></div>
</div>
<div id="submit-dereplicator" class="section level4 hasAnchor" number="5.1.4.2">
<h4><span class="header-section-number">5.1.4.2</span> Submit Dereplicator<a href="ms2-annotation.html#submit-dereplicator" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="ms2-annotation.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_utils_annotation, <span class="st">&quot;/GNPS_upload_submitjobs.R&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="dereplicator-plus" class="section level3 hasAnchor" number="5.1.5">
<h3><span class="header-section-number">5.1.5</span> <a href="https://ccms-ucsd.github.io/GNPSDocumentation/dereplicator%2B/">Dereplicator plus</a><a href="ms2-annotation.html#dereplicator-plus" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="generate-parameters-2" class="section level4 hasAnchor" number="5.1.5.1">
<h4><span class="header-section-number">5.1.5.1</span> Generate parameters 🕵<a href="#generate-parameters-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="ms2-annotation.html#cb66-1" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator_plus <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb66-2"><a href="ms2-annotation.html#cb66-2" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator_plus[<span class="st">&quot;precursor_ion_mass_tolerance&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.02&quot;</span></span>
<span id="cb66-3"><a href="ms2-annotation.html#cb66-3" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator_plus[<span class="st">&quot;fragment_ion_mass_tolerance&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.02&quot;</span></span>
<span id="cb66-4"><a href="ms2-annotation.html#cb66-4" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator_plus[<span class="st">&quot;max_charge&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;2&quot;</span> <span class="co"># other options are 1 and 3</span></span>
<span id="cb66-5"><a href="ms2-annotation.html#cb66-5" aria-hidden="true" tabindex="-1"></a>parameters_CMN_Dereplicator_plus[<span class="st">&quot;min_score&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;12&quot;</span></span></code></pre></div>
</div>
<div id="submit-dereplicator-plus" class="section level4 hasAnchor" number="5.1.5.2">
<h4><span class="header-section-number">5.1.5.2</span> Submit Dereplicator plus<a href="ms2-annotation.html#submit-dereplicator-plus" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="ms2-annotation.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_utils_annotation, <span class="st">&quot;/GNPS_upload_submitjobs.R&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="nap" class="section level3 hasAnchor" number="5.1.6">
<h3><span class="header-section-number">5.1.6</span> <a href="https://ccms-ucsd.github.io/GNPSDocumentation/nap/">NAP</a><a href="ms2-annotation.html#nap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="generate-parameters-3" class="section level4 hasAnchor" number="5.1.6.1">
<h4><span class="header-section-number">5.1.6.1</span> Generate parameters 🕵<a href="#generate-parameters-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><font color = "red">*parameters are different from different polarities</font></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="ms2-annotation.html#cb68-1" aria-hidden="true" tabindex="-1"></a>parameters_CMN_NAP <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb68-2"><a href="ms2-annotation.html#cb68-2" aria-hidden="true" tabindex="-1"></a>parameters_CMN_NAP[<span class="st">&quot;number_of_a_cluster_index&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0&quot;</span></span>
<span id="cb68-3"><a href="ms2-annotation.html#cb68-3" aria-hidden="true" tabindex="-1"></a>parameters_CMN_NAP[<span class="st">&quot;cosine_value_to_subselect_inside_a_cluster&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.7&quot;</span> </span>
<span id="cb68-4"><a href="ms2-annotation.html#cb68-4" aria-hidden="true" tabindex="-1"></a>parameters_CMN_NAP[<span class="st">&quot;n_first_candidates_for_consensus_score&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;10&quot;</span></span>
<span id="cb68-5"><a href="ms2-annotation.html#cb68-5" aria-hidden="true" tabindex="-1"></a>parameters_CMN_NAP[<span class="st">&quot;use_fusion_result_for_consensus&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;on&quot;</span> <span class="co"># if deselect, &quot;&quot;</span></span>
<span id="cb68-6"><a href="ms2-annotation.html#cb68-6" aria-hidden="true" tabindex="-1"></a>parameters_CMN_NAP[<span class="st">&quot;accuracy_for_exact_mass_candidate_search_ppm&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;15&quot;</span></span>
<span id="cb68-7"><a href="ms2-annotation.html#cb68-7" aria-hidden="true" tabindex="-1"></a>parameters_CMN_NAP[<span class="st">&quot;structure_database&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;GNPS,HMDB,SUPNAT,NPAtlas,CHEBI,DRUGBANK,FooDB&quot;</span> </span>
<span id="cb68-8"><a href="ms2-annotation.html#cb68-8" aria-hidden="true" tabindex="-1"></a>parameters_CMN_NAP[<span class="st">&quot;maximum_number_of_candidate_structures_in_the_graph&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;10&quot;</span></span></code></pre></div>
<p><font color = "red">Be careful the inputs of parameters depending on the polarity, so only change the inputs related to the polarity you are working on</font></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="ms2-annotation.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (polarity <span class="sc">==</span> <span class="st">&quot;POS&quot;</span>) {</span>
<span id="cb69-2"><a href="ms2-annotation.html#cb69-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-3"><a href="ms2-annotation.html#cb69-3" aria-hidden="true" tabindex="-1"></a>  parameters_CMN_NAP[<span class="st">&quot;acquisition_mode&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Positive&quot;</span></span>
<span id="cb69-4"><a href="ms2-annotation.html#cb69-4" aria-hidden="true" tabindex="-1"></a>  parameters_CMN_NAP[<span class="st">&quot;adduct_ion_type&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;[M+H]&quot;</span> <span class="co"># other options are &quot;[M]&quot;,&quot;[M+NH4]&quot;,&quot;[M+Na]&quot;,&quot;[M+K]&quot;, &quot;[M+ACN+H]&quot; </span></span>
<span id="cb69-5"><a href="ms2-annotation.html#cb69-5" aria-hidden="true" tabindex="-1"></a>  parameters_CMN_NAP[<span class="st">&quot;multiple_adduct_types&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;[M+Na]&quot;</span> </span>
<span id="cb69-6"><a href="ms2-annotation.html#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="ms2-annotation.html#cb69-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (polarity <span class="sc">==</span> <span class="st">&quot;NEG&quot;</span>) {</span>
<span id="cb69-8"><a href="ms2-annotation.html#cb69-8" aria-hidden="true" tabindex="-1"></a>    parameters_CMN_NAP[<span class="st">&quot;acquisition_mode&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Negative&quot;</span> </span>
<span id="cb69-9"><a href="ms2-annotation.html#cb69-9" aria-hidden="true" tabindex="-1"></a>    parameters_CMN_NAP[<span class="st">&quot;adduct_ion_type&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;[M-H]&quot;</span> <span class="co"># other options are &quot;[M+Cl]&quot;, &quot;[M+FA-H]&quot;</span></span>
<span id="cb69-10"><a href="ms2-annotation.html#cb69-10" aria-hidden="true" tabindex="-1"></a>    parameters_CMN_NAP[<span class="st">&quot;multiple_adduct_types&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;[M+Cl]&quot;</span></span>
<span id="cb69-11"><a href="ms2-annotation.html#cb69-11" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb69-12"><a href="ms2-annotation.html#cb69-12" aria-hidden="true" tabindex="-1"></a>  }   </span></code></pre></div>
</div>
<div id="submit-nap" class="section level4 hasAnchor" number="5.1.6.2">
<h4><span class="header-section-number">5.1.6.2</span> Submit NAP<a href="ms2-annotation.html#submit-nap" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="ms2-annotation.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_utils_annotation, <span class="st">&quot;/GNPS_upload_submitjobs.R&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="ms2lda" class="section level3 hasAnchor" number="5.1.7">
<h3><span class="header-section-number">5.1.7</span> <a href="https://ccms-ucsd.github.io/GNPSDocumentation/ms2lda/">MS2LDA</a><a href="ms2-annotation.html#ms2lda" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="generate-parameters-4" class="section level4 hasAnchor" number="5.1.7.1">
<h4><span class="header-section-number">5.1.7.1</span> Generate parameters 🕵<a href="#generate-parameters-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="ms2-annotation.html#cb71-1" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb71-2"><a href="ms2-annotation.html#cb71-2" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA[<span class="st">&quot;bin_width&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.01&quot;</span> <span class="co">#other options are 0.005, 0.05, 0.1, 0.5</span></span>
<span id="cb71-3"><a href="ms2-annotation.html#cb71-3" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA[<span class="st">&quot;number_of_lda_iterations&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1000&quot;</span></span>
<span id="cb71-4"><a href="ms2-annotation.html#cb71-4" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA[<span class="st">&quot;minimum_ms2_intensity&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;100&quot;</span></span>
<span id="cb71-5"><a href="ms2-annotation.html#cb71-5" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA[<span class="st">&quot;lda_free_motifs&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;200&quot;</span></span>
<span id="cb71-6"><a href="ms2-annotation.html#cb71-6" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA[<span class="st">&quot;gnps_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;yes&quot;</span> <span class="co">#if deselect, &quot;no&quot;</span></span>
<span id="cb71-7"><a href="ms2-annotation.html#cb71-7" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA[<span class="st">&quot;massbank_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;yes&quot;</span></span>
<span id="cb71-8"><a href="ms2-annotation.html#cb71-8" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA[<span class="st">&quot;urine_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;yes&quot;</span> </span>
<span id="cb71-9"><a href="ms2-annotation.html#cb71-9" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA[<span class="st">&quot;euphorbia_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;no&quot;</span></span>
<span id="cb71-10"><a href="ms2-annotation.html#cb71-10" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA[<span class="st">&quot;rhamnaceae_plant_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;no&quot;</span></span>
<span id="cb71-11"><a href="ms2-annotation.html#cb71-11" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA[<span class="st">&quot;streptomyces_and_salinisporus_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;no&quot;</span></span>
<span id="cb71-12"><a href="ms2-annotation.html#cb71-12" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA[<span class="st">&quot;photorhabdus_and_xenorhabdus_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;no&quot;</span> </span>
<span id="cb71-13"><a href="ms2-annotation.html#cb71-13" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA[<span class="st">&quot;user_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;None&quot;</span> </span>
<span id="cb71-14"><a href="ms2-annotation.html#cb71-14" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA[<span class="st">&quot;overlap_score_threshold&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.3&quot;</span></span>
<span id="cb71-15"><a href="ms2-annotation.html#cb71-15" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA[<span class="st">&quot;probability_value_threshold&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.1&quot;</span></span>
<span id="cb71-16"><a href="ms2-annotation.html#cb71-16" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MS2LDA[<span class="st">&quot;topx_in_node&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;5&quot;</span> </span></code></pre></div>
</div>
<div id="submit-ms2lda" class="section level4 hasAnchor" number="5.1.7.2">
<h4><span class="header-section-number">5.1.7.2</span> Submit MS2LDA<a href="ms2-annotation.html#submit-ms2lda" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="ms2-annotation.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_utils_annotation, <span class="st">&quot;/GNPS_upload_submitjobs.R&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="mne-molnetenhancer" class="section level3 hasAnchor" number="5.1.8">
<h3><span class="header-section-number">5.1.8</span> <a href="https://ccms-ucsd.github.io/GNPSDocumentation/molnetenhancer/">MNE (MolNetEnhancer)</a><a href="ms2-annotation.html#mne-molnetenhancer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="generate-parameters-5" class="section level4 hasAnchor" number="5.1.8.1">
<h4><span class="header-section-number">5.1.8.1</span> Generate parameters 🕵<a href="#generate-parameters-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="ms2-annotation.html#cb73-1" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MNE <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb73-2"><a href="ms2-annotation.html#cb73-2" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MNE[<span class="st">&quot;enter_varquest_id&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;None&quot;</span>    <span class="co"># leave it as &quot;None&quot; if this id is not available </span></span>
<span id="cb73-3"><a href="ms2-annotation.html#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="ms2-annotation.html#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="ms2-annotation.html#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">&quot;list_jobid&quot;</span>)) {</span>
<span id="cb73-6"><a href="ms2-annotation.html#cb73-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-7"><a href="ms2-annotation.html#cb73-7" aria-hidden="true" tabindex="-1"></a>  list_jobid <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(path_outputs_params_jobids, <span class="st">&quot;/jobids_CMN_&quot;</span>, project_name, <span class="st">&quot;_&quot;</span>, round, <span class="st">&quot;_&quot;</span>, sample_type, <span class="st">&quot;_&quot;</span>, omics, <span class="st">&quot;_&quot;</span>, method, <span class="st">&quot;_&quot;</span>, polarity, <span class="st">&quot;.rds&quot;</span>))</span>
<span id="cb73-8"><a href="ms2-annotation.html#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="ms2-annotation.html#cb73-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-10"><a href="ms2-annotation.html#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="ms2-annotation.html#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="ms2-annotation.html#cb73-12" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MNE[<span class="st">&quot;enter_nap_id&quot;</span>] <span class="ot">&lt;-</span> list_jobid<span class="sc">$</span>CMN_NAP_task_id  </span>
<span id="cb73-13"><a href="ms2-annotation.html#cb73-13" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MNE[<span class="st">&quot;enter_gnps_task_id&quot;</span>] <span class="ot">&lt;-</span> list_jobid<span class="sc">$</span>CMN_task_id</span>
<span id="cb73-14"><a href="ms2-annotation.html#cb73-14" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MNE[<span class="st">&quot;enter_Dereplicator_id&quot;</span>] <span class="ot">&lt;-</span> list_jobid<span class="sc">$</span>CMN_Dereplicator_task_id</span>
<span id="cb73-15"><a href="ms2-annotation.html#cb73-15" aria-hidden="true" tabindex="-1"></a>parameters_CMN_MNE[<span class="st">&quot;enter_ms2lda_job_id&quot;</span>] <span class="ot">&lt;-</span> list_jobid<span class="sc">$</span>CMN_MS2LDA_task_id  <span class="co"># ms2lda_task_id_pos$ms2lda. Leave it as &quot;None&quot; if this id is not available</span></span></code></pre></div>
</div>
<div id="submit-mne" class="section level4 hasAnchor" number="5.1.8.2">
<h4><span class="header-section-number">5.1.8.2</span> Submit MNE<a href="ms2-annotation.html#submit-mne" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="ms2-annotation.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_utils_annotation, <span class="st">&quot;/GNPS_upload_submitjobs.R&quot;</span>))</span></code></pre></div>
</div>
</div>
</div>
<div id="gnps-submit-jobs-based-on-fbmn" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> GNPS-Submit jobs based on FBMN<a href="ms2-annotation.html#gnps-submit-jobs-based-on-fbmn" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You only need to prepare a reprocessed MS2-spectra as the format of <code>.mgf</code> and the corresponding quantification table as the format of <code>.txt</code></p>
<p><font color = "red">change the parameters in the sections below related to the workflows you would like to run</font></p>
<div id="form-quantification-table" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Form quantification table<a href="ms2-annotation.html#form-quantification-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The script <code>0b.Pipeline_quan_table.R</code> is available under the folder of <code>J:\CBMR\SUN-CBMR-Metabolomics\Workflow\Script\modules\MS2_Annotation</code></p>
<div id="source-paths-on-the-server-6" class="section level4 hasAnchor" number="5.2.1.1">
<h4><span class="header-section-number">5.2.1.1</span> Source paths on the server<a href="ms2-annotation.html#source-paths-on-the-server-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="ms2-annotation.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;H:/From_SUND/Scripts/utils/utils_MS2_set_up/set_up_paths.R&quot;</span>)</span></code></pre></div>
</div>
<div id="provide-the-polarity-2" class="section level4 hasAnchor" number="5.2.1.2">
<h4><span class="header-section-number">5.2.1.2</span> Provide the polarity 🕵<a href="#provide-the-polarity-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="ms2-annotation.html#cb76-1" aria-hidden="true" tabindex="-1"></a>polarity <span class="ot">&lt;-</span> <span class="st">&quot;POS&quot;</span></span></code></pre></div>
</div>
<div id="path-of-storing-outputs-5" class="section level4 hasAnchor" number="5.2.1.3">
<h4><span class="header-section-number">5.2.1.3</span> Path of storing outputs 🕵<a href="#path-of-storing-outputs-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="ms2-annotation.html#cb77-1" aria-hidden="true" tabindex="-1"></a>path_output <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs&quot;</span></span></code></pre></div>
</div>
<div id="path-of-extracted-ms2-spectra" class="section level4 hasAnchor" number="5.2.1.4">
<h4><span class="header-section-number">5.2.1.4</span> Path of extracted MS2 spectra 🕵<a href="#path-of-extracted-ms2-spectra" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="ms2-annotation.html#cb78-1" aria-hidden="true" tabindex="-1"></a>path_rds_expMS2 <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs/exp_MS2_POS.rds&quot;</span> </span></code></pre></div>
</div>
<div id="path-of-object-after-conducting-xcms" class="section level4 hasAnchor" number="5.2.1.5">
<h4><span class="header-section-number">5.2.1.5</span> Path of object after conducting XCMS 🕵<a href="#path-of-object-after-conducting-xcms" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="ms2-annotation.html#cb79-1" aria-hidden="true" tabindex="-1"></a>path_rds_xcms_XCMSnExp <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs/xcms_XCMSnExp_POS.rds&quot;</span> </span></code></pre></div>
</div>
<div id="optional-path-of-object-camera-if-conduct-camera" class="section level4 hasAnchor" number="5.2.1.6">
<h4><span class="header-section-number">5.2.1.6</span> (Optional) Path of object CAMERA (if conduct CAMERA) ✈️<a href="ms2-annotation.html#optional-path-of-object-camera-if-conduct-camera" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><font color = "red">If you have run CAMERA, please provide the path, otherwise, skip running the line below</font></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="ms2-annotation.html#cb80-1" aria-hidden="true" tabindex="-1"></a>path_rds_cam_xsAnnotate <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs/cam_xsAnnotate_POS.rds&quot;</span> </span></code></pre></div>
</div>
<div id="conduct-to-get-quantification-table-for-fbmn-on-gnps" class="section level4 hasAnchor" number="5.2.1.7">
<h4><span class="header-section-number">5.2.1.7</span> Conduct to get quantification table for FBMN on GNPS<a href="ms2-annotation.html#conduct-to-get-quantification-table-for-fbmn-on-gnps" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="ms2-annotation.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">&quot;path_rds_cam_xsAnnotate&quot;</span>)) {</span>
<span id="cb81-2"><a href="ms2-annotation.html#cb81-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-3"><a href="ms2-annotation.html#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Type of intensity value to extract from object of xcms_XCMSnExp</span></span>
<span id="cb81-4"><a href="ms2-annotation.html#cb81-4" aria-hidden="true" tabindex="-1"></a>  feature_int <span class="ot">&lt;-</span> <span class="st">&quot;into&quot;</span></span>
<span id="cb81-5"><a href="ms2-annotation.html#cb81-5" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb81-6"><a href="ms2-annotation.html#cb81-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-7"><a href="ms2-annotation.html#cb81-7" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb81-8"><a href="ms2-annotation.html#cb81-8" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb81-9"><a href="ms2-annotation.html#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">&quot;ku_00007&quot;</span>, path_rds_expMS2)) {</span>
<span id="cb81-10"><a href="ms2-annotation.html#cb81-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-11"><a href="ms2-annotation.html#cb81-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">source</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb81-12"><a href="ms2-annotation.html#cb81-12" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb81-13"><a href="ms2-annotation.html#cb81-13" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {<span class="fu">source</span>(<span class="fu">paste0</span>(path_utils_annotation, <span class="st">&quot;/quan_table.R&quot;</span>))}</span></code></pre></div>
</div>
</div>
<div id="upload-files-generate-parameters-and-submit-jobs" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Upload files, generate parameters, and submit jobs<a href="ms2-annotation.html#upload-files-generate-parameters-and-submit-jobs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The script <code>1b.Pipeline_GNPS_upload_submitjobs_based on FBMN.R</code> is available under the folder of <code>J:\CBMR\SUN-CBMR-Metabolomics\Workflow\Script\modules\MS2_Annotation</code></p>
<div class="Keats">
The pipeline is for: <span class="math inline">\(\\\)</span>
1.Uploading files to the server of GNPS. <span class="math inline">\(\\\)</span>
2.Generating parameters for each job you would like to run. <span class="math inline">\(\\\)</span>
3.Running FBMN (feature based molecular network) and a couple of other jobs based on FBMN on GNPS. <span class="math inline">\(\\\)</span>
<div class="Keats_red">
4.Changing the parameters related to the jobs you would like to run.
</div>
</div>
<div id="upload-files-1" class="section level4 hasAnchor" number="5.2.2.1">
<h4><span class="header-section-number">5.2.2.1</span> Upload files<a href="ms2-annotation.html#upload-files-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="source-paths-on-the-server-and-relevant-function-1" class="section level5 hasAnchor" number="5.2.2.1.1">
<h5><span class="header-section-number">5.2.2.1.1</span> Source paths on the server and relevant function<a href="ms2-annotation.html#source-paths-on-the-server-and-relevant-function-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="ms2-annotation.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;H:/From_SUND/Scripts/utils/utils_MS2_set_up/set_up_paths.R&quot;</span>)</span>
<span id="cb82-2"><a href="ms2-annotation.html#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_func, <span class="st">&quot;/files_by_FTP.R&quot;</span>))</span></code></pre></div>
</div>
<div id="provide-polarity-upper-case-1" class="section level5 hasAnchor" number="5.2.2.1.2">
<h5><span class="header-section-number">5.2.2.1.2</span> Provide polarity (upper case) 🕵<a href="#provide-polarity-upper-case-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="ms2-annotation.html#cb83-1" aria-hidden="true" tabindex="-1"></a>polarity <span class="ot">&lt;-</span> <span class="st">&quot;POS&quot;</span></span></code></pre></div>
</div>
<div id="provide-project-information-1" class="section level5 hasAnchor" number="5.2.2.1.3">
<h5><span class="header-section-number">5.2.2.1.3</span> Provide project information 🕵<a href="#provide-project-information-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="ms2-annotation.html#cb84-1" aria-hidden="true" tabindex="-1"></a>project_name <span class="ot">&lt;-</span> <span class="st">&quot;workflow_test&quot;</span> </span>
<span id="cb84-2"><a href="ms2-annotation.html#cb84-2" aria-hidden="true" tabindex="-1"></a>round <span class="ot">&lt;-</span> <span class="st">&quot;1&quot;</span>            <span class="co">#what ordinal number comes current samples? e.g. &quot;1&quot;, or &quot;2&quot;,...</span></span>
<span id="cb84-3"><a href="ms2-annotation.html#cb84-3" aria-hidden="true" tabindex="-1"></a>sample_type <span class="ot">&lt;-</span> <span class="st">&quot;serum&quot;</span></span>
<span id="cb84-4"><a href="ms2-annotation.html#cb84-4" aria-hidden="true" tabindex="-1"></a>omics <span class="ot">&lt;-</span> <span class="st">&quot;metabolomics&quot;</span></span>
<span id="cb84-5"><a href="ms2-annotation.html#cb84-5" aria-hidden="true" tabindex="-1"></a>method <span class="ot">&lt;-</span> <span class="st">&quot;RF&quot;</span></span></code></pre></div>
</div>
<div id="information-related-to-run-jobs-on-gnps-or-computer-room-1" class="section level5 hasAnchor" number="5.2.2.1.4">
<h5><span class="header-section-number">5.2.2.1.4</span> Information related to run jobs on GNPS or computer room 🕵<a href="#information-related-to-run-jobs-on-gnps-or-computer-room-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="ms2-annotation.html#cb85-1" aria-hidden="true" tabindex="-1"></a>username <span class="ot">&lt;-</span> <span class="st">&quot;cherish_199271&quot;</span></span>
<span id="cb85-2"><a href="ms2-annotation.html#cb85-2" aria-hidden="true" tabindex="-1"></a>password <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb85-3"><a href="ms2-annotation.html#cb85-3" aria-hidden="true" tabindex="-1"></a>host <span class="ot">&lt;-</span> <span class="st">&quot;massive.ucsd.edu&quot;</span></span>
<span id="cb85-4"><a href="ms2-annotation.html#cb85-4" aria-hidden="true" tabindex="-1"></a>email <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span></code></pre></div>
</div>
<div id="provide-the-path-of-storing-files-without-filenames-1" class="section level5 hasAnchor" number="5.2.2.1.5">
<h5><span class="header-section-number">5.2.2.1.5</span> Provide the path of storing files without filenames 🕵<a href="#provide-the-path-of-storing-files-without-filenames-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="ms2-annotation.html#cb86-1" aria-hidden="true" tabindex="-1"></a>masterpath <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs&quot;</span></span></code></pre></div>
</div>
<div id="provide-the-filenames" class="section level5 hasAnchor" number="5.2.2.1.6">
<h5><span class="header-section-number">5.2.2.1.6</span> Provide the filenames 🕵<a href="#provide-the-filenames" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><code>.txt</code> of quantification table and <code>.mgf</code> file of MS2 spectra</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="ms2-annotation.html#cb87-1" aria-hidden="true" tabindex="-1"></a>filenames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;quantable_POS.txt&quot;</span>, <span class="st">&quot;exp_MS2_POS.mgf&quot;</span>)</span></code></pre></div>
</div>
<div id="provide-method-you-used-for-preprocessing-the-ms2-spectra-data" class="section level5 hasAnchor" number="5.2.2.1.7">
<h5><span class="header-section-number">5.2.2.1.7</span> Provide method you used for preprocessing the MS2-spectra data 🕵<a href="#provide-method-you-used-for-preprocessing-the-ms2-spectra-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="ms2-annotation.html#cb88-1" aria-hidden="true" tabindex="-1"></a>prep_method <span class="ot">&lt;-</span> <span class="st">&quot;XCMS3&quot;</span> <span class="co">#other options are illustrated within the function in the file of &quot;submit_jobs_to_GNPS.R&quot;</span></span></code></pre></div>
</div>
<div id="upload-files-into-server-ftp-1" class="section level5 hasAnchor" number="5.2.2.1.8">
<h5><span class="header-section-number">5.2.2.1.8</span> Upload files into server (FTP)<a href="ms2-annotation.html#upload-files-into-server-ftp-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="ms2-annotation.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upload_file_FTP</span>(masterpath, filenames, username, password, host, project_name, round, sample_type, omics, method, polarity)</span></code></pre></div>
</div>
</div>
<div id="prerequisites-before-generating-parameters-and-submitting-jobs-1" class="section level4 hasAnchor" number="5.2.2.2">
<h4><span class="header-section-number">5.2.2.2</span> Prerequisites before generating parameters and submitting jobs 🕵<a href="#prerequisites-before-generating-parameters-and-submitting-jobs-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="ms2-annotation.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Provide the path for storing the lists of both parameters and job ids  </span></span>
<span id="cb90-2"><a href="ms2-annotation.html#cb90-2" aria-hidden="true" tabindex="-1"></a>path_outputs_params_jobids <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs&quot;</span></span>
<span id="cb90-3"><a href="ms2-annotation.html#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="ms2-annotation.html#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="ms2-annotation.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="co">#The two lines below are for storing all parameters related to the workflows you will run</span></span>
<span id="cb90-6"><a href="ms2-annotation.html#cb90-6" aria-hidden="true" tabindex="-1"></a>list_param <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb90-7"><a href="ms2-annotation.html#cb90-7" aria-hidden="true" tabindex="-1"></a>list_jobid <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code></pre></div>
</div>
<div id="fbmn" class="section level4 hasAnchor" number="5.2.2.3">
<h4><span class="header-section-number">5.2.2.3</span> <a href="https://ccms-ucsd.github.io/GNPSDocumentation/featurebasedmolecularnetworking/">FBMN</a><a href="ms2-annotation.html#fbmn" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="generate-parameters-6" class="section level5 hasAnchor" number="5.2.2.3.1">
<h5><span class="header-section-number">5.2.2.3.1</span> Generate parameters 🕵<a href="#generate-parameters-6" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="ms2-annotation.html#cb91-1" aria-hidden="true" tabindex="-1"></a>parameters_FBMN <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb91-2"><a href="ms2-annotation.html#cb91-2" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;precursor_ion_mass_tolerance&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.02&quot;</span></span>
<span id="cb91-3"><a href="ms2-annotation.html#cb91-3" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;fragment_ion_mass_tolerance&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.02&quot;</span></span>
<span id="cb91-4"><a href="ms2-annotation.html#cb91-4" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;min_pairs_cos&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.7&quot;</span></span>
<span id="cb91-5"><a href="ms2-annotation.html#cb91-5" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;minimum_matched_fragment_ions&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;6&quot;</span></span>
<span id="cb91-6"><a href="ms2-annotation.html#cb91-6" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;maximum_shift&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;500&quot;</span></span>
<span id="cb91-7"><a href="ms2-annotation.html#cb91-7" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;network_topk&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;10&quot;</span></span>
<span id="cb91-8"><a href="ms2-annotation.html#cb91-8" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;maximum_connected_component_size&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;100&quot;</span></span>
<span id="cb91-9"><a href="ms2-annotation.html#cb91-9" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;library_search_min_matched_peaks&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;6&quot;</span></span>
<span id="cb91-10"><a href="ms2-annotation.html#cb91-10" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;score_threshold&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.7&quot;</span></span>
<span id="cb91-11"><a href="ms2-annotation.html#cb91-11" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;search_analogs&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0&quot;</span> <span class="co"># don&#39;t search/ &quot;1&quot; search</span></span>
<span id="cb91-12"><a href="ms2-annotation.html#cb91-12" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;maximum_analog_search_mass_difference&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;100&quot;</span> <span class="co"># it only works once select the search analog</span></span>
<span id="cb91-13"><a href="ms2-annotation.html#cb91-13" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;top_results_to_report_per_query&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1&quot;</span></span>
<span id="cb91-14"><a href="ms2-annotation.html#cb91-14" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;minimum_peak_intensity&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.0&quot;</span></span>
<span id="cb91-15"><a href="ms2-annotation.html#cb91-15" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;filter_precursor_window&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1&quot;</span> <span class="co"># filter / &quot;0&quot; don&#39;t filter</span></span>
<span id="cb91-16"><a href="ms2-annotation.html#cb91-16" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;filter_library&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1&quot;</span> <span class="co"># filter / &quot;0&quot; don&#39;t filter</span></span>
<span id="cb91-17"><a href="ms2-annotation.html#cb91-17" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;filter_peaks_10_50Da_window&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1&quot;</span> <span class="co"># filter / &quot;0&quot; don&#39;t filter</span></span>
<span id="cb91-18"><a href="ms2-annotation.html#cb91-18" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;normalization_per_file&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;None&quot;</span> <span class="co"># represent no normalization, the other option is &quot;RowSum&quot;</span></span>
<span id="cb91-19"><a href="ms2-annotation.html#cb91-19" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;aggregation_method_for_peak_abundances_per_group&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Mean&quot;</span> <span class="co"># another option is &quot;Sum&quot;</span></span>
<span id="cb91-20"><a href="ms2-annotation.html#cb91-20" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;pcoa_distance_metric&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;cosine&quot;</span> <span class="co"># other options are &quot;braycurtis&quot;, &quot;euclidean&quot;, &quot;jaccard&quot;</span></span>
<span id="cb91-21"><a href="ms2-annotation.html#cb91-21" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;metadata_column_to_compare&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;None&quot;</span></span>
<span id="cb91-22"><a href="ms2-annotation.html#cb91-22" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;run_stats_and_plots&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;No&quot;</span> <span class="co"># other option is &quot;Yes&quot;</span></span>
<span id="cb91-23"><a href="ms2-annotation.html#cb91-23" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;metadata_field_to_compare_1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;None&quot;</span></span>
<span id="cb91-24"><a href="ms2-annotation.html#cb91-24" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;metadata_field_to_compare_2&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;None&quot;</span></span>
<span id="cb91-25"><a href="ms2-annotation.html#cb91-25" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;metadata_column_to_facet&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;None&quot;</span></span>
<span id="cb91-26"><a href="ms2-annotation.html#cb91-26" aria-hidden="true" tabindex="-1"></a>parameters_FBMN[<span class="st">&quot;run_Dereplicator&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1&quot;</span> <span class="co"># &quot;0&quot; represent don&#39;t run and &quot;1&quot; represents run</span></span></code></pre></div>
</div>
<div id="submit-fbmn" class="section level5 hasAnchor" number="5.2.2.3.2">
<h5><span class="header-section-number">5.2.2.3.2</span> Submit FBMN<a href="ms2-annotation.html#submit-fbmn" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="ms2-annotation.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_utils_annotation, <span class="st">&quot;/GNPS_upload_submitjobs.R&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="dereplicator-plus-1" class="section level4 hasAnchor" number="5.2.2.4">
<h4><span class="header-section-number">5.2.2.4</span> <a href="https://ccms-ucsd.github.io/GNPSDocumentation/dereplicator%2B/">Dereplicator plus</a><a href="ms2-annotation.html#dereplicator-plus-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="generate-parameters-7" class="section level5 hasAnchor" number="5.2.2.4.1">
<h5><span class="header-section-number">5.2.2.4.1</span> Generate parameters 🕵<a href="#generate-parameters-7" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="ms2-annotation.html#cb93-1" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_Dereplicator_plus <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb93-2"><a href="ms2-annotation.html#cb93-2" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_Dereplicator_plus[<span class="st">&quot;precursor_ion_mass_tolerance&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.02&quot;</span></span>
<span id="cb93-3"><a href="ms2-annotation.html#cb93-3" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_Dereplicator_plus[<span class="st">&quot;fragment_ion_mass_tolerance&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.02&quot;</span></span>
<span id="cb93-4"><a href="ms2-annotation.html#cb93-4" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_Dereplicator_plus[<span class="st">&quot;max_charge&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;2&quot;</span> <span class="co"># other options are 1 and 3</span></span>
<span id="cb93-5"><a href="ms2-annotation.html#cb93-5" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_Dereplicator_plus[<span class="st">&quot;min_score&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;12&quot;</span></span></code></pre></div>
</div>
<div id="submit-dereplicator-plus-1" class="section level5 hasAnchor" number="5.2.2.4.2">
<h5><span class="header-section-number">5.2.2.4.2</span> Submit Dereplicator plus<a href="ms2-annotation.html#submit-dereplicator-plus-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="ms2-annotation.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_utils_annotation, <span class="st">&quot;/GNPS_upload_submitjobs.R&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="nap-1" class="section level4 hasAnchor" number="5.2.2.5">
<h4><span class="header-section-number">5.2.2.5</span> <a href="https://ccms-ucsd.github.io/GNPSDocumentation/nap/">NAP</a><a href="ms2-annotation.html#nap-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><font color = "red">*parameters are different from different polarities</font>
##### Generate parameters 🕵</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="ms2-annotation.html#cb95-1" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_NAP <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb95-2"><a href="ms2-annotation.html#cb95-2" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_NAP[<span class="st">&quot;number_of_a_cluster_index&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0&quot;</span></span>
<span id="cb95-3"><a href="ms2-annotation.html#cb95-3" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_NAP[<span class="st">&quot;cosine_value_to_subselect_inside_a_cluster&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.7&quot;</span> </span>
<span id="cb95-4"><a href="ms2-annotation.html#cb95-4" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_NAP[<span class="st">&quot;n_first_candidates_for_consensus_score&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;10&quot;</span></span>
<span id="cb95-5"><a href="ms2-annotation.html#cb95-5" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_NAP[<span class="st">&quot;use_fusion_result_for_consensus&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;on&quot;</span> <span class="co"># if deselect, &quot;&quot;</span></span>
<span id="cb95-6"><a href="ms2-annotation.html#cb95-6" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_NAP[<span class="st">&quot;accuracy_for_exact_mass_candidate_search_ppm&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;15&quot;</span></span>
<span id="cb95-7"><a href="ms2-annotation.html#cb95-7" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_NAP[<span class="st">&quot;structure_database&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;GNPS,HMDB,SUPNAT,NPAtlas,CHEBI,DRUGBANK,FooDB&quot;</span> </span>
<span id="cb95-8"><a href="ms2-annotation.html#cb95-8" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_NAP[<span class="st">&quot;maximum_number_of_candidate_structures_in_the_graph&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;10&quot;</span></span></code></pre></div>
<p><font color = "red">Be careful the inputs of parameters depending on the polarity, so only change the inputs related to the polarity you are working on</font></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="ms2-annotation.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (polarity <span class="sc">==</span> <span class="st">&quot;POS&quot;</span>) {</span>
<span id="cb96-2"><a href="ms2-annotation.html#cb96-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-3"><a href="ms2-annotation.html#cb96-3" aria-hidden="true" tabindex="-1"></a>  parameters_FBMN_NAP[<span class="st">&quot;acquisition_mode&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Positive&quot;</span></span>
<span id="cb96-4"><a href="ms2-annotation.html#cb96-4" aria-hidden="true" tabindex="-1"></a>  parameters_FBMN_NAP[<span class="st">&quot;adduct_ion_type&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;[M+H]&quot;</span> <span class="co"># other options are &quot;[M]&quot;, &quot;[M+NH4]&quot;, &quot;[M+Na]&quot;, &quot;[M+K]&quot;, &quot;[M+ACN+H]&quot; </span></span>
<span id="cb96-5"><a href="ms2-annotation.html#cb96-5" aria-hidden="true" tabindex="-1"></a>  parameters_FBMN_NAP[<span class="st">&quot;multiple_adduct_types&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;[M+Na]&quot;</span> </span>
<span id="cb96-6"><a href="ms2-annotation.html#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="ms2-annotation.html#cb96-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (polarity <span class="sc">==</span> <span class="st">&quot;NEG&quot;</span>) {</span>
<span id="cb96-8"><a href="ms2-annotation.html#cb96-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-9"><a href="ms2-annotation.html#cb96-9" aria-hidden="true" tabindex="-1"></a>  parameters_FBMN_NAP[<span class="st">&quot;acquisition_mode&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Negative&quot;</span> </span>
<span id="cb96-10"><a href="ms2-annotation.html#cb96-10" aria-hidden="true" tabindex="-1"></a>  parameters_FBMN_NAP[<span class="st">&quot;adduct_ion_type&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;[M-H]&quot;</span> <span class="co"># other options are &quot;[M+Cl]&quot;, &quot;[M+FA-H]&quot;</span></span>
<span id="cb96-11"><a href="ms2-annotation.html#cb96-11" aria-hidden="true" tabindex="-1"></a>  parameters_FBMN_NAP[<span class="st">&quot;multiple_adduct_types&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;[M+Cl]&quot;</span></span>
<span id="cb96-12"><a href="ms2-annotation.html#cb96-12" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb96-13"><a href="ms2-annotation.html#cb96-13" aria-hidden="true" tabindex="-1"></a>}  </span></code></pre></div>
<div id="submit-nap-1" class="section level5 hasAnchor" number="5.2.2.5.1">
<h5><span class="header-section-number">5.2.2.5.1</span> Submit NAP<a href="ms2-annotation.html#submit-nap-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="ms2-annotation.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_utils_annotation, <span class="st">&quot;/GNPS_upload_submitjobs.R&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="optional-ms2lda" class="section level4 hasAnchor" number="5.2.2.6">
<h4><span class="header-section-number">5.2.2.6</span> (Optional) <a href="https://ccms-ucsd.github.io/GNPSDocumentation/ms2lda/">MS2LDA</a> ✈️<a href="ms2-annotation.html#optional-ms2lda" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><font color = "red">It is only available when you preprocessed MS2 by MZmine</font>
##### Generate parameters 🕵</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="ms2-annotation.html#cb98-1" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb98-2"><a href="ms2-annotation.html#cb98-2" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA[<span class="st">&quot;bin_width&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.01&quot;</span> <span class="co">#other options are 0.005, 0.05, 0.1, 0.5</span></span>
<span id="cb98-3"><a href="ms2-annotation.html#cb98-3" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA[<span class="st">&quot;number_of_lda_iterations&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1000&quot;</span></span>
<span id="cb98-4"><a href="ms2-annotation.html#cb98-4" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA[<span class="st">&quot;minimum_ms2_intensity&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;100&quot;</span></span>
<span id="cb98-5"><a href="ms2-annotation.html#cb98-5" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA[<span class="st">&quot;lda_free_motifs&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;200&quot;</span></span>
<span id="cb98-6"><a href="ms2-annotation.html#cb98-6" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA[<span class="st">&quot;gnps_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;yes&quot;</span> <span class="co">#if deselect, &quot;no&quot;</span></span>
<span id="cb98-7"><a href="ms2-annotation.html#cb98-7" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA[<span class="st">&quot;massbank_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;yes&quot;</span></span>
<span id="cb98-8"><a href="ms2-annotation.html#cb98-8" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA[<span class="st">&quot;urine_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;yes&quot;</span> </span>
<span id="cb98-9"><a href="ms2-annotation.html#cb98-9" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA[<span class="st">&quot;euphorbia_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;no&quot;</span></span>
<span id="cb98-10"><a href="ms2-annotation.html#cb98-10" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA[<span class="st">&quot;rhamnaceae_plant_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;no&quot;</span></span>
<span id="cb98-11"><a href="ms2-annotation.html#cb98-11" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA[<span class="st">&quot;streptomyces_and_salinisporus_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;no&quot;</span></span>
<span id="cb98-12"><a href="ms2-annotation.html#cb98-12" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA[<span class="st">&quot;photorhabdus_and_xenorhabdus_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;no&quot;</span> </span>
<span id="cb98-13"><a href="ms2-annotation.html#cb98-13" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA[<span class="st">&quot;user_motif_inclusion&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;None&quot;</span> </span>
<span id="cb98-14"><a href="ms2-annotation.html#cb98-14" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA[<span class="st">&quot;overlap_score_threshold&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.3&quot;</span></span>
<span id="cb98-15"><a href="ms2-annotation.html#cb98-15" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA[<span class="st">&quot;probability_value_threshold&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0.1&quot;</span></span>
<span id="cb98-16"><a href="ms2-annotation.html#cb98-16" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MS2LDA[<span class="st">&quot;topx_in_node&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;5&quot;</span> </span></code></pre></div>
<div id="submit-ms2lda-1" class="section level5 hasAnchor" number="5.2.2.6.1">
<h5><span class="header-section-number">5.2.2.6.1</span> Submit MS2LDA<a href="ms2-annotation.html#submit-ms2lda-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="ms2-annotation.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_utils_annotation, <span class="st">&quot;/GNPS_upload_submitjobs.R&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="mne-molnetenhancer-1" class="section level4 hasAnchor" number="5.2.2.7">
<h4><span class="header-section-number">5.2.2.7</span> <a href="https://ccms-ucsd.github.io/GNPSDocumentation/molnetenhancer/">MNE (MolNetEnhancer)</a><a href="ms2-annotation.html#mne-molnetenhancer-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="generate-parameters-8" class="section level5 hasAnchor" number="5.2.2.7.1">
<h5><span class="header-section-number">5.2.2.7.1</span> Generate parameters 🕵<a href="#generate-parameters-8" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="ms2-annotation.html#cb100-1" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MNE <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb100-2"><a href="ms2-annotation.html#cb100-2" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MNE[<span class="st">&quot;enter_varquest_id&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;None&quot;</span>    <span class="co"># leave it as &quot;None&quot; if this id is not available </span></span>
<span id="cb100-3"><a href="ms2-annotation.html#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="ms2-annotation.html#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="ms2-annotation.html#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">&quot;list_jobid&quot;</span>)) {</span>
<span id="cb100-6"><a href="ms2-annotation.html#cb100-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb100-7"><a href="ms2-annotation.html#cb100-7" aria-hidden="true" tabindex="-1"></a>  list_jobid <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(path_outputs_params_jobids, <span class="st">&quot;/jobids_FBMN_&quot;</span>, project_name, <span class="st">&quot;_&quot;</span>, round, <span class="st">&quot;_&quot;</span>, sample_type, <span class="st">&quot;_&quot;</span>, omics, <span class="st">&quot;_&quot;</span>, method, <span class="st">&quot;_&quot;</span>, polarity, <span class="st">&quot;.rds&quot;</span>))</span>
<span id="cb100-8"><a href="ms2-annotation.html#cb100-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-9"><a href="ms2-annotation.html#cb100-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb100-10"><a href="ms2-annotation.html#cb100-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-11"><a href="ms2-annotation.html#cb100-11" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MNE[<span class="st">&quot;enter_nap_id&quot;</span>] <span class="ot">&lt;-</span> list_jobid<span class="sc">$</span>FBMN_NAP_task_id</span>
<span id="cb100-12"><a href="ms2-annotation.html#cb100-12" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MNE[<span class="st">&quot;enter_gnps_task_id&quot;</span>] <span class="ot">&lt;-</span> list_jobid<span class="sc">$</span>FBMN_task_id</span></code></pre></div>
<p><font color = "red">If you preprocess your MS2 data by using MZmine, replace the value below with id of job MS2LDA</font></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="ms2-annotation.html#cb101-1" aria-hidden="true" tabindex="-1"></a>parameters_FBMN_MNE[<span class="st">&quot;enter_ms2lda_job_id&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;None&quot;</span></span></code></pre></div>
</div>
<div id="submit-mne-1" class="section level5 hasAnchor" number="5.2.2.7.2">
<h5><span class="header-section-number">5.2.2.7.2</span> Submit MNE<a href="ms2-annotation.html#submit-mne-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="ms2-annotation.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_utils_annotation, <span class="st">&quot;/GNPS_upload_submitjobs.R&quot;</span>))</span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="gnps-download-jobs" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> GNPS-Download jobs<a href="ms2-annotation.html#gnps-download-jobs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The script <code>2.Pipeline_GNPS_download_jobs.R</code> is available under the folder of <code>J:\CBMR\SUN-CBMR-Metabolomics\Workflow\Script\modules\MS2_Annotation</code></p>
<div id="source-paths-on-the-server-7" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Source paths on the server 🕵<a href="#source-paths-on-the-server-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="ms2-annotation.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;H:/From_SUND/Scripts/utils/utils_MS2_set_up/set_up_paths.R&quot;</span>)</span></code></pre></div>
</div>
<div id="provide-polarity-upper-case-2" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Provide polarity (upper case) 🕵<a href="#provide-polarity-upper-case-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="ms2-annotation.html#cb104-1" aria-hidden="true" tabindex="-1"></a>polarity <span class="ot">&lt;-</span> <span class="st">&quot;POS&quot;</span></span></code></pre></div>
</div>
<div id="provide-the-path-of-storing-downloaded-files" class="section level3 hasAnchor" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Provide the path of storing downloaded files 🕵<a href="#provide-the-path-of-storing-downloaded-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="ms2-annotation.html#cb105-1" aria-hidden="true" tabindex="-1"></a>download_path <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs&quot;</span></span></code></pre></div>
</div>
<div id="provide-project-information-2" class="section level3 hasAnchor" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> Provide project information 🕵<a href="#provide-project-information-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="ms2-annotation.html#cb106-1" aria-hidden="true" tabindex="-1"></a>project_name <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb106-2"><a href="ms2-annotation.html#cb106-2" aria-hidden="true" tabindex="-1"></a>round <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb106-3"><a href="ms2-annotation.html#cb106-3" aria-hidden="true" tabindex="-1"></a>sample_type <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb106-4"><a href="ms2-annotation.html#cb106-4" aria-hidden="true" tabindex="-1"></a>omics <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb106-5"><a href="ms2-annotation.html#cb106-5" aria-hidden="true" tabindex="-1"></a>method <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span></code></pre></div>
</div>
<div id="provide-the-absolute-path-of-list-of-job-ids-by-including-the-name-of-that-list" class="section level3 hasAnchor" number="5.3.5">
<h3><span class="header-section-number">5.3.5</span> Provide the absolute path of “list of job ids” by including the name of that list 🕵<a href="#provide-the-absolute-path-of-list-of-job-ids-by-including-the-name-of-that-list" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><font color = "red">name should start with <strong>jobid</strong></font></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="ms2-annotation.html#cb107-1" aria-hidden="true" tabindex="-1"></a>path_list <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs/jobids_CMN_workflow_test_1_serum_metabolomics_RF_POS.rds&quot;</span></span></code></pre></div>
</div>
<div id="download-results-from-the-list-of-job-ids" class="section level3 hasAnchor" number="5.3.6">
<h3><span class="header-section-number">5.3.6</span> Download results from the list of job ids<a href="ms2-annotation.html#download-results-from-the-list-of-job-ids" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="ms2-annotation.html#cb108-1" aria-hidden="true" tabindex="-1"></a>list_jobid <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(path_list)</span>
<span id="cb108-2"><a href="ms2-annotation.html#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_utils_annotation, <span class="st">&quot;/GNPS_downloadjobs.R&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="ms2-inhouse-library-v.s.-experimental-data" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> MS2-inhouse-library v.s. experimental data<a href="ms2-annotation.html#ms2-inhouse-library-v.s.-experimental-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The script <code>1c.Pipeline_exp_vs_lib.R</code> is available under the folder of <code>J:\CBMR\SUN-CBMR-Metabolomics\Workflow\Script\modules\MS2_Annotation</code></p>
<div id="source-paths-on-the-server-8" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Source paths on the server<a href="ms2-annotation.html#source-paths-on-the-server-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="ms2-annotation.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;H:/From_SUND/Scripts/utils/utils_MS2_set_up/set_up_paths.R&quot;</span>)</span></code></pre></div>
</div>
<div id="provide-polarity-upper-case-3" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Provide polarity (upper case) 🕵<a href="#provide-polarity-upper-case-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="ms2-annotation.html#cb110-1" aria-hidden="true" tabindex="-1"></a>polarity <span class="ot">&lt;-</span> <span class="st">&quot;POS&quot;</span> <span class="co"># &quot;POS&quot; &quot;NEG&quot;</span></span></code></pre></div>
</div>
<div id="provide-path-of-preprocessed-ms2-spectra-file" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Provide path of preprocessed MS2-spectra file 🕵<a href="#provide-path-of-preprocessed-ms2-spectra-file" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><font color = "red">It is the absolute path by including the file name as the format of <code>*.mgf</code></font></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="ms2-annotation.html#cb111-1" aria-hidden="true" tabindex="-1"></a>path_mgf_expMS2 <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs/exp_MS2_POS.mgf&quot;</span></span></code></pre></div>
</div>
<div id="provide-the-thresholds" class="section level3 hasAnchor" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> provide the thresholds 🕵<a href="#provide-the-thresholds" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>They are for m/z and similarity score which is used for cutting off the matches with the scores lower than the threshold</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="ms2-annotation.html#cb112-1" aria-hidden="true" tabindex="-1"></a>mz_threshold <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb112-2"><a href="ms2-annotation.html#cb112-2" aria-hidden="true" tabindex="-1"></a>cor_threshold <span class="ot">&lt;-</span> <span class="fl">0.7</span></span></code></pre></div>
</div>
<div id="provide-the-path-of-storing-output" class="section level3 hasAnchor" number="5.4.5">
<h3><span class="header-section-number">5.4.5</span> Provide the path of storing output 🕵<a href="#provide-the-path-of-storing-output" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="ms2-annotation.html#cb113-1" aria-hidden="true" tabindex="-1"></a>path_output <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs&quot;</span></span></code></pre></div>
</div>
<div id="optional-provide-the-method-for-comparison" class="section level3 hasAnchor" number="5.4.6">
<h3><span class="header-section-number">5.4.6</span> (Optional) Provide the method for comparison ✈️<a href="ms2-annotation.html#optional-provide-the-method-for-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="Keats">
The default method is <code>cp_method &lt;- "cosine"</code> you could also try other methods for comparison “nspecanglescore”, “navdistscore”, or “neuclideanscore”
</div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="ms2-annotation.html#cb114-1" aria-hidden="true" tabindex="-1"></a>cp_method <span class="ot">&lt;-</span> <span class="st">&quot;cosine&quot;</span></span></code></pre></div>
</div>
<div id="conduct-1" class="section level3 hasAnchor" number="5.4.7">
<h3><span class="header-section-number">5.4.7</span> Conduct<a href="ms2-annotation.html#conduct-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="ms2-annotation.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (polarity <span class="sc">==</span> <span class="st">&quot;POS&quot;</span>) {</span>
<span id="cb115-2"><a href="ms2-annotation.html#cb115-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-3"><a href="ms2-annotation.html#cb115-3" aria-hidden="true" tabindex="-1"></a>  path_lib_MS2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(path_MS2_lib, <span class="st">&quot;/RP_lib_MS2_60_POS.mgf&quot;</span>)</span>
<span id="cb115-4"><a href="ms2-annotation.html#cb115-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-5"><a href="ms2-annotation.html#cb115-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (polarity <span class="sc">==</span> <span class="st">&quot;NEG&quot;</span>) {</span>
<span id="cb115-6"><a href="ms2-annotation.html#cb115-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb115-7"><a href="ms2-annotation.html#cb115-7" aria-hidden="true" tabindex="-1"></a>  path_lib_MS2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(path_MS2_lib, <span class="st">&quot;/RP_lib_MS2_60_NEG.mgf&quot;</span>)</span>
<span id="cb115-8"><a href="ms2-annotation.html#cb115-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-9"><a href="ms2-annotation.html#cb115-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb115-10"><a href="ms2-annotation.html#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_func, <span class="st">&quot;/lib_vs_exp_MS2.R&quot;</span>))</span>
<span id="cb115-11"><a href="ms2-annotation.html#cb115-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-12"><a href="ms2-annotation.html#cb115-12" aria-hidden="true" tabindex="-1"></a><span class="fu">MS2_vs_exp</span>(path_lib_MS2, path_mgf_expMS2, mz_threshold, cor_threshold, polarity, path_output, cp_method)</span></code></pre></div>
</div>
</div>
<div id="merge-results-from-different-source" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Merge results from different source<a href="ms2-annotation.html#merge-results-from-different-source" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="merging-outputs-from-jobs-have-run-on-gnps-into-a-table" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Merging outputs from jobs have run on GNPS into a table<a href="ms2-annotation.html#merging-outputs-from-jobs-have-run-on-gnps-into-a-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The script <code>3.Pipeline_merge_outputs_from_GNPS.R</code> is available under the folder of <code>J:\CBMR\SUN-CBMR-Metabolomics\Workflow\Script\modules\MS2_Annotation</code></p>
<div id="source-paths-on-the-server-and-relevant-function-2" class="section level4 hasAnchor" number="5.5.1.1">
<h4><span class="header-section-number">5.5.1.1</span> Source paths on the server and relevant function<a href="ms2-annotation.html#source-paths-on-the-server-and-relevant-function-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="ms2-annotation.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;H:/From_SUND/Scripts/utils/utils_MS2_set_up/set_up_paths.R&quot;</span>)</span>
<span id="cb116-2"><a href="ms2-annotation.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_func, <span class="st">&quot;/Merge_outputs_from_GNPS.R&quot;</span>))</span></code></pre></div>
</div>
<div id="provide-the-path-of-storing-files-downloaded-from-gnps" class="section level4 hasAnchor" number="5.5.1.2">
<h4><span class="header-section-number">5.5.1.2</span> Provide the path of storing files downloaded from GNPS 🕵<a href="#provide-the-path-of-storing-files-downloaded-from-gnps" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><font color = "red">The path should be end with <strong>gnps_outputs</strong></font></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="ms2-annotation.html#cb117-1" aria-hidden="true" tabindex="-1"></a>path_downloaded_files <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs/workflow_test_1_serum_metabolomics_RF/gnps_outputs&quot;</span></span></code></pre></div>
</div>
<div id="provide-the-absolute-path-of-list-of-job-ids-by-including-the-name-of-that-list-1" class="section level4 hasAnchor" number="5.5.1.3">
<h4><span class="header-section-number">5.5.1.3</span> Provide the absolute path of “list of job ids” by including the name of that list 🕵<a href="#provide-the-absolute-path-of-list-of-job-ids-by-including-the-name-of-that-list-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><font color = "red">name should start with <strong>jobids</strong></font></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="ms2-annotation.html#cb118-1" aria-hidden="true" tabindex="-1"></a>path_list <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs/jobids_CMN_workflow_test_1_serum_metabolomics_RF_POS.rds&quot;</span></span></code></pre></div>
</div>
<div id="provide-path-for-storing-the-merged-result" class="section level4 hasAnchor" number="5.5.1.4">
<h4><span class="header-section-number">5.5.1.4</span> Provide path for storing the merged result 🕵<a href="#provide-path-for-storing-the-merged-result" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="ms2-annotation.html#cb119-1" aria-hidden="true" tabindex="-1"></a>path_outputs <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs&quot;</span></span></code></pre></div>
</div>
<div id="provide-which-method-did-you-use-for-preprocessing-ms2-data" class="section level4 hasAnchor" number="5.5.1.5">
<h4><span class="header-section-number">5.5.1.5</span> Provide which method did you use for preprocessing MS2 data 🕵<a href="#provide-which-method-did-you-use-for-preprocessing-ms2-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><font color = "red">If you run jobs based on CMN, skip running the line below</font></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="ms2-annotation.html#cb120-1" aria-hidden="true" tabindex="-1"></a>prep_method <span class="ot">&lt;-</span> <span class="st">&quot;XCMS3&quot;</span></span></code></pre></div>
</div>
<div id="provide-polarity-upper-case-4" class="section level4 hasAnchor" number="5.5.1.6">
<h4><span class="header-section-number">5.5.1.6</span> Provide polarity (upper case) 🕵<a href="#provide-polarity-upper-case-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="ms2-annotation.html#cb121-1" aria-hidden="true" tabindex="-1"></a>polarity <span class="ot">&lt;-</span> <span class="st">&quot;POS&quot;</span></span></code></pre></div>
</div>
<div id="conduct-2" class="section level4 hasAnchor" number="5.5.1.7">
<h4><span class="header-section-number">5.5.1.7</span> Conduct<a href="ms2-annotation.html#conduct-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="ms2-annotation.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb122-2"><a href="ms2-annotation.html#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="ms2-annotation.html#cb122-3" aria-hidden="true" tabindex="-1"></a>list_jobid <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(path_list)</span>
<span id="cb122-4"><a href="ms2-annotation.html#cb122-4" aria-hidden="true" tabindex="-1"></a>workflow <span class="ot">&lt;-</span> <span class="fu">names</span>(list_jobids) <span class="sc">%&gt;%</span> <span class="fu">gsub</span>(<span class="st">&quot;_task_id&quot;</span>, <span class="st">&quot;&quot;</span>,.) <span class="sc">%&gt;%</span> <span class="fu">strsplit</span>(<span class="st">&quot;[A-Z]+_&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">unique</span>() <span class="sc">%&gt;%</span> <span class="fu">na_if</span>(<span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() </span>
<span id="cb122-5"><a href="ms2-annotation.html#cb122-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-6"><a href="ms2-annotation.html#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Merge_outputs_from_GNPS</span>(path_downloaded_files, prep_method, workflow, polarity, path_output)</span></code></pre></div>
</div>
<div id="merge-library-match-into-gnps-match" class="section level4 hasAnchor" number="5.5.1.8">
<h4><span class="header-section-number">5.5.1.8</span> Merge library-match into GNPS-match<a href="ms2-annotation.html#merge-library-match-into-gnps-match" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The script <code>4.Pipeline_merge_lib-match_GNPS-match.R</code> is available under the folder of <code>J:\CBMR\SUN-CBMR-Metabolomics\Workflow\Script\modules\MS2_Annotation</code></p>
<p><font color = "red"> it is more precise to merge the result from library-match with the results from FBMN-based jobs on GNPS</font></p>
<div id="source-paths-on-the-server-9" class="section level5 hasAnchor" number="5.5.1.8.1">
<h5><span class="header-section-number">5.5.1.8.1</span> Source paths on the server<a href="ms2-annotation.html#source-paths-on-the-server-9" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="ms2-annotation.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;H:/From_SUND/Scripts/utils/utils_MS2_set_up/set_up_paths.R&quot;</span>)</span></code></pre></div>
</div>
<div id="provide-path-of-excel-file-of-storing-matched-records-and-sheet-names" class="section level5 hasAnchor" number="5.5.1.8.2">
<h5><span class="header-section-number">5.5.1.8.2</span> Provide path of excel file of storing matched records and sheet names 🕵<a href="#provide-path-of-excel-file-of-storing-matched-records-and-sheet-names" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The file name should be like <code>MS2-match-outputs.xlsx</code> and please provide the absolute path</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="ms2-annotation.html#cb124-1" aria-hidden="true" tabindex="-1"></a>path_MS2_match <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs/MS2-match-outputs.xlsx&quot;</span></span>
<span id="cb124-2"><a href="ms2-annotation.html#cb124-2" aria-hidden="true" tabindex="-1"></a>sheetName_GNPS <span class="ot">&lt;-</span> <span class="st">&quot;GNPS_summary_based_FBMN_POS&quot;</span></span>
<span id="cb124-3"><a href="ms2-annotation.html#cb124-3" aria-hidden="true" tabindex="-1"></a>sheetName_lib <span class="ot">&lt;-</span> <span class="st">&quot;MS2-lib-vs-exp_cosine_POS&quot;</span></span></code></pre></div>
</div>
<div id="provide-the-polarity-upper-case" class="section level5 hasAnchor" number="5.5.1.8.3">
<h5><span class="header-section-number">5.5.1.8.3</span> Provide the polarity (upper case) 🕵<a href="#provide-the-polarity-upper-case" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="ms2-annotation.html#cb125-1" aria-hidden="true" tabindex="-1"></a>polarity <span class="ot">&lt;-</span> <span class="st">&quot;POS&quot;</span></span></code></pre></div>
</div>
<div id="provide-the-path-for-storing-output" class="section level5 hasAnchor" number="5.5.1.8.4">
<h5><span class="header-section-number">5.5.1.8.4</span> Provide the path for storing output 🕵<a href="#provide-the-path-for-storing-output" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="ms2-annotation.html#cb126-1" aria-hidden="true" tabindex="-1"></a>path_output <span class="ot">&lt;-</span> <span class="st">&quot;H:/From_SUND/Scripts/outputs&quot;</span></span></code></pre></div>
</div>
<div id="conduct-3" class="section level5 hasAnchor" number="5.5.1.8.5">
<h5><span class="header-section-number">5.5.1.8.5</span> Conduct<a href="ms2-annotation.html#conduct-3" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="ms2-annotation.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(path_utils_annotation, <span class="st">&quot;/merge_lib-match_GNPS-match.R&quot;</span>))</span></code></pre></div>

</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ms2-preprocessing-targeted.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="small-tools.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/MuyaoXi9271/Instructions_MS2-workflow_robot/edit/master/03-MS2_Annotation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/MuyaoXi9271/Instructions_MS2-workflow_robot/blob/master/03-MS2_Annotation.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
